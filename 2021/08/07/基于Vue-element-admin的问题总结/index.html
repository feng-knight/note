<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/note/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/note/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/note/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/note/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/note/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/note/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/note/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="1.  vue-element-admin 打包部署到线上服务器 vue-element-admin一个基于vue2.0和 Eelement 的控制面板 UI框架，这是使用vue技术栈开发的前端程序员的首选管理系统模板，模板以及非常的成熟了，并且有相关的社区和维护人员，开发时候遇到问题也不要慌。  推荐指数：star:55kGithub 地址：https:&#x2F;&#x2F;github.com&#x2F;PanJiaCh">
<meta property="og:type" content="article">
<meta property="og:title" content="基于Vue-element-admin的问题总结">
<meta property="og:url" content="https://feng-knight.github.io/note/2021/08/07/%E5%9F%BA%E4%BA%8EVue-element-admin%E7%9A%84%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93/index.html">
<meta property="og:site_name" content="F゛">
<meta property="og:description" content="1.  vue-element-admin 打包部署到线上服务器 vue-element-admin一个基于vue2.0和 Eelement 的控制面板 UI框架，这是使用vue技术栈开发的前端程序员的首选管理系统模板，模板以及非常的成熟了，并且有相关的社区和维护人员，开发时候遇到问题也不要慌。  推荐指数：star:55kGithub 地址：https:&#x2F;&#x2F;github.com&#x2F;PanJiaCh">
<meta property="og:image" content="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0xUUHJTbEtDTUlSaWFkRmcwT1JoMHR3alE3aWNLaWN0UHlpYTZ5anpOck44MklKQ1RPUHlyc3FjQ01BLzY0MA?x-oss-process=image/format,png">
<meta property="og:image" content="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0xxRDFoVmJOSmlhYllFUmNXMHpnZ2VuQU1rVmt3WkU0M3puZ1huTE5Xa1dIN2x2ZHpOV1JFWTVnLzY0MA?x-oss-process=image/format,png">
<meta property="og:image" content="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0w4STc5Q2ozRlBxYUM2cUJZa2JGeHUwTFdTb0FUVTNGb01hRnY2Y1hocENsOHlNVlA2aWJxRW1RLzY0MA?x-oss-process=image/format,png">
<meta property="og:image" content="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0w5RFJacUlIMFB4anFtNE9kVjdCczBFajRaS01Od2pESkVwTmQ3cnFNc3E2Skp3aWJJdWgzSExRLzY0MA?x-oss-process=image/format,png">
<meta property="og:image" content="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0xEQW9qVXNMY2liaWN6SFB5ejIzRHhhQjZoUEZyV1lUT0hLb2ljQWpYNnJwaWNLejRXR2UzdzlTUWpBLzY0MA?x-oss-process=image/format,png">
<meta property="og:image" content="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0w1SVhVcEFWYTFTUFJDSXN5dlFIaWJaVnhhVWljblNWOFJ1a2lhdTlvVFdqZjlsaWFjQW1rUWhaek9nLzY0MA?x-oss-process=image/format,png">
<meta property="og:image" content="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0xPVW9MV05GNkFITDJ0RGt5N3BJZ3ZxYjMzczVpYnpIRzVMWDlIYjR6V29IRXV2dGtQeEhhRHdRLzY0MA?x-oss-process=image/format,png">
<meta property="og:image" content="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0xEb2x1VHUxeFRpYmhraWF1V0tCTVRHbWViNGFYRENNY0hNQUJwc2liYmQxaFFBaGp5eE5MSEhJVUEvNjQw?x-oss-process=image/format,png">
<meta property="og:image" content="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0xGbHp0MTUzSDllcEtnc0pzN2JHaEY3THFyaGg2cnBEck1aWWlhNGFpY2VWRGZFTm5ONHFTMjFUUS82NDA?x-oss-process=image/format,png">
<meta property="og:image" content="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0xEWVBJcFFNQTBSR2x3VkNGNnZDdVFqbFp1NGljWWYyN25ndlVHam1LYmd5aWE4NlE3MWJzSUkzUS82NDA?x-oss-process=image/format,png">
<meta property="og:image" content="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0w5dGppYkJyOHF0cDRPMFpCRWVTM2xSaE9PaWFJUmxRekVmdHJxVWJLVFUxOUFuVzlBdmFRT001QS82NDA?x-oss-process=image/format,png">
<meta property="og:image" content="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0xLcmVLc1g1cERLRFkwZ0Q1TWpvUzE1UVRmWnpocDNXZEl3bllwZlRlTWY2YTVtQ2NwcHBaS3cvNjQw?x-oss-process=image/format,png">
<meta property="og:image" content="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0x6UnYxWXo3Mk00SHkyTTVmdjQxTzFuaktJbzFOTmFweDdxcVFsQU1WYUVoZWZZWFRwcDlJSlEvNjQw?x-oss-process=image/format,png">
<meta property="og:image" content="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0wybVlicVFjWGM3bmliMUFNeDVNUERnbVlsUzFoT0lOYUVjdDZjREgxeEg0aWF5VlJHOHlmNGliQ2cvNjQw?x-oss-process=image/format,png">
<meta property="og:image" content="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0x4eUU5YThyTFRadHJlbzNTenlJbkhmaWMxNjc2NXlvOHhiWWliSjJSZ00xRjYzQ0lFSW1JdEdWdy82NDA?x-oss-process=image/format,png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/2020070116031524.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3lfd194X2s=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200701160927688.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3lfd194X2s=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200618095047468.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzU2Nzg4Nw==,size_16,color_FFFFFF,t_70#pic_center">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/14776980-f1161304bff12fee.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/442/format/webp">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/14776980-2773972d05f01c69.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/14776980-e0e64920681bc8fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/14776980-7cdad7c915e1202f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/14776980-dc975c09d658016a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1128/format/webp">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/14776980-6f0cb0ac34a2aea9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/14776980-96be5d8aeffe477d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/14776980-a77cb298693538ed.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp">
<meta property="og:image" content="https://img-blog.csdnimg.cn/2020061019464222.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjQwNDg1,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200610194930471.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjQwNDg1,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://common.cnblogs.com/images/copycode.gif">
<meta property="og:image" content="https://common.cnblogs.com/images/copycode.gif">
<meta property="og:image" content="https://common.cnblogs.com/images/copycode.gif">
<meta property="og:image" content="https://common.cnblogs.com/images/copycode.gif">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20191230164323153.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3cxNDE4ODk5NTMy,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20191230164843407.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3cxNDE4ODk5NTMy,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20191230165107864.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3cxNDE4ODk5NTMy,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20191230165546424.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200527155556770.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlYl9zdGFydA==,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200527155741686.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlYl9zdGFydA==,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201029185345538.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxMjg3MTU4,size_16,color_FFFFFF,t_70#pic_center">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201029185407405.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxMjg3MTU4,size_16,color_FFFFFF,t_70#pic_center">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201029185455426.png#pic_center">
<meta property="og:image" content="https://segmentfault.com/img/remote/1460000022758520">
<meta property="og:image" content="https://segmentfault.com/img/remote/1460000022758521">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20210517174422724.gif">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200225101120880.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMzNDI2MzI0,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img2020.cnblogs.com/blog/1324387/202003/1324387-20200324142009227-1312904100.gif">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1324387/201903/1324387-20190315145117238-128781339.png">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1324387/201905/1324387-20190524134827292-1343993864.png">
<meta property="og:image" content="https://img-blog.csdn.net/20180620104650848?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI5NDY4NTcz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201204103838359.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyODA1NTY5,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201204104522301.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyODA1NTY5,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201204104604840.png">
<meta property="og:image" content="https://img.diandian100.cn/20210317141955.png">
<meta property="og:image" content="https://img.diandian100.cn/20210317142411.png">
<meta property="og:image" content="https://img.diandian100.cn/20210317142732.png">
<meta property="og:image" content="https://img.diandian100.cn/20210317143536.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200510042629546.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200510042830299.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIwNjQ5MTQz,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200510043030539.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIwNjQ5MTQz,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200510044402710.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIwNjQ5MTQz,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20190529164958564.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N4czE5OTU=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20190529165103884.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N4czE5OTU=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20190529165850380.png">
<meta property="article:published_time" content="2021-08-07T09:15:58.000Z">
<meta property="article:modified_time" content="2021-08-07T09:15:58.000Z">
<meta property="article:author" content="F゛">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0xUUHJTbEtDTUlSaWFkRmcwT1JoMHR3alE3aWNLaWN0UHlpYTZ5anpOck44MklKQ1RPUHlyc3FjQ01BLzY0MA?x-oss-process=image/format,png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/note/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://feng-knight.github.io/note/2021/08/07/基于Vue-element-admin的问题总结/"/>





  <title>基于Vue-element-admin的问题总结 | F゛</title>
  








<meta name="generator" content="Hexo 4.2.1"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/note/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">F゛</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">既然已经走了这么远了，不如再往前走一走.(Now that we have come so far, we might as well go a little further.)</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/note/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/note/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://feng-knight.github.io/note/note/2021/08/07/%E5%9F%BA%E4%BA%8EVue-element-admin%E7%9A%84%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="F゛">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/note/images/dog.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="F゛">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">基于Vue-element-admin的问题总结</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-08-07T17:15:58+08:00">
                2021-08-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h4 id="1-vue-element-admin-打包部署到线上服务器"><a href="#1-vue-element-admin-打包部署到线上服务器" class="headerlink" title="1.  vue-element-admin 打包部署到线上服务器"></a>1. <font color="#00AFF0"> vue-element-admin 打包部署到线上服务器</font></h4><ul>
<li><p><code>vue-element-admin</code>一个基于<code>vue2.0</code>和 <code>Eelement</code> 的控制面板 <code>UI</code>框架，这是使用<code>vue</code>技术栈开发的前端程序员的首选管理系统模板，模板以及非常的成熟了，并且有相关的社区和维护人员，开发时候遇到问题也不要慌。</p>
</li>
<li><p>推荐指数：<code>star:55k</code><br><code>Github</code> 地址：<a href="https://github.com/PanJiaChen/vue-element-admin" target="_blank" rel="noopener">https://github.com/PanJiaChen/vue-element-admin</a><br><code>Demo</code>体验：<a href="https://panjiachen.github.io/vue-element-admin/#/dashboard" target="_blank" rel="noopener">https://panjiachen.github.io/vue-element-admin/#/dashboard</a></p>
</li>
<li><p>文档：<a href="https://panjiachen.github.io/vue-element-admin-site/zh/" target="_blank" rel="noopener">https://panjiachen.github.io/vue-element-admin-site/zh/</a></p>
</li>
</ul>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0xUUHJTbEtDTUlSaWFkRmcwT1JoMHR3alE3aWNLaWN0UHlpYTZ5anpOck44MklKQ1RPUHlyc3FjQ01BLzY0MA?x-oss-process=image/format,png" alt="img"></p>
<p>今天就来说一下，怎使用这个模板，以及写好了项目，怎么样把项目打包成静态文件，部署在服务器上。</p>
<p>1：去<code>github</code>上面下载或者克隆<br><code>Github</code> 地址：<a href="https://github.com/PanJiaChen/vue-element-admin" target="_blank" rel="noopener">https://github.com/PanJiaChen/vue-element-admin</a><br>我这里使用简单粗暴的方式，直接下点击载按钮</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0xxRDFoVmJOSmlhYllFUmNXMHpnZ2VuQU1rVmt3WkU0M3puZ1huTE5Xa1dIN2x2ZHpOV1JFWTVnLzY0MA?x-oss-process=image/format,png" alt="img"></p>
<p>2：使用<code>vscode</code>打开，进入项目目录<code>cd vue-element-admin</code>，并且在项目里面安装依赖。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --registry=[https:<span class="comment">//registry.npm.taobao.org](https://registry.npm.taobao.org)</span></span><br></pre></td></tr></table></figure>

<p>建议不要用<code>cnpm</code> 安装 会有各种诡异的bug 可以通过如下操作解决<code>npm</code>下载速度慢的问题</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0w4STc5Q2ozRlBxYUM2cUJZa2JGeHUwTFdTb0FUVTNGb01hRnY2Y1hocENsOHlNVlA2aWJxRW1RLzY0MA?x-oss-process=image/format,png" alt="img"></p>
<p>安装完成会发现项目目录中多了一个依赖文件夹</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0w5RFJacUlIMFB4anFtNE9kVjdCczBFajRaS01Od2pESkVwTmQ3cnFNc3E2Skp3aWJJdWgzSExRLzY0MA?x-oss-process=image/format,png" alt="img"></p>
<p>3：运行本地开发 启动项目</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br></pre></td></tr></table></figure>

<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0xEQW9qVXNMY2liaWN6SFB5ejIzRHhhQjZoUEZyV1lUT0hLb2ljQWpYNnJwaWNLejRXR2UzdzlTUWpBLzY0MA?x-oss-process=image/format,png" alt="img"></p>
<p>4：浏览器打开<br>运行成功就使用浏览器打开<br><a href="http://localhost:9527/" target="_blank" rel="noopener">http://localhost:9527/</a></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0w1SVhVcEFWYTFTUFJDSXN5dlFIaWJaVnhhVWljblNWOFJ1a2lhdTlvVFdqZjlsaWFjQW1rUWhaek9nLzY0MA?x-oss-process=image/format,png" alt="img"></p>
<p>可以在这个后台管理系统的模板的基础上，修改一些自己需要的代码，变成自己的开发的项目了，此处自行发挥，省略一万字。</p>
<p>5：打包成静态文件<br>做好项目之后，需要开始打包了，打包成一个dist静态文件夹。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm run build:prod</span><br><span class="line">（prod 对应的是生成环境的配置内容）</span><br></pre></td></tr></table></figure>

<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0xPVW9MV05GNkFITDJ0RGt5N3BJZ3ZxYjMzczVpYnpIRzVMWDlIYjR6V29IRXV2dGtQeEhhRHdRLzY0MA?x-oss-process=image/format,png" alt="img"></p>
<p>打包成功之后<br>会出现一个这样的dist文件夹</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0xEb2x1VHUxeFRpYmhraWF1V0tCTVRHbWViNGFYRENNY0hNQUJwc2liYmQxaFFBaGp5eE5MSEhJVUEvNjQw?x-oss-process=image/format,png" alt="img"></p>
<p>6：查看本地<code>index.html</code>，在本地打开<br>选择在默认的浏览器打开</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0xGbHp0MTUzSDllcEtnc0pzN2JHaEY3THFyaGg2cnBEck1aWWlhNGFpY2VWRGZFTm5ONHFTMjFUUS82NDA?x-oss-process=image/format,png" alt="img"></p>
<p>但是这个时候我们会发现空白页<br>怎么办？<br>打开<code>f12</code>来看一下是什么情况吧</p>
<p>这里的报错是这样的</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0xEWVBJcFFNQTBSR2x3VkNGNnZDdVFqbFp1NGljWWYyN25ndlVHam1LYmd5aWE4NlE3MWJzSUkzUS82NDA?x-oss-process=image/format,png" alt="img"></p>
<p>解决办法：</p>
<p>正常<code>vue</code>项目是要修改<code>config</code>文件夹下的<code>index.js</code>可是<code>vue-element-admin</code>项目没有这个文件<br>那就找到并且打开vue.config.js</p>
<p>将 <code>publicPath:&#39;/&#39;</code>,改成<code>publicPath:&#39;./&#39;</code></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0w5dGppYkJyOHF0cDRPMFpCRWVTM2xSaE9PaWFJUmxRekVmdHJxVWJLVFUxOUFuVzlBdmFRT001QS82NDA?x-oss-process=image/format,png" alt="img"></p>
<p>再次执行，<code>npm run build:prod</code>命令<br>重新打包<br>这个时候，就可以直接在本地打开静态文件dist里面的<code>index.html</code>页面了。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0xLcmVLc1g1cERLRFkwZ0Q1TWpvUzE1UVRmWnpocDNXZEl3bllwZlRlTWY2YTVtQ2NwcHBaS3cvNjQw?x-oss-process=image/format,png" alt="img"></p>
<p>注意：如果修改了路径，点击登录按钮，还是不能跳转的话，可以考虑一下修改<code>router/index.js</code>里面的路由</p>
<p>将</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> createRouter = <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">new</span> Router(&#123;</span><br><span class="line">  mode:<span class="string">'history'</span>, <span class="comment">// require service support</span></span><br><span class="line">  scrollBehavior:<span class="function"><span class="params">()</span> =&gt;</span> (&#123; <span class="attr">y</span>:<span class="number">0</span> &#125;),</span><br><span class="line">  routes:constantRoutes</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>改成</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> createRouter = <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">new</span> Router(&#123;</span><br><span class="line">  mode:<span class="string">'hash'</span>, <span class="comment">// require service support</span></span><br><span class="line">  scrollBehavior:<span class="function"><span class="params">()</span> =&gt;</span> (&#123; <span class="attr">y</span>:<span class="number">0</span> &#125;),</span><br><span class="line">  routes:constantRoutes</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0x6UnYxWXo3Mk00SHkyTTVmdjQxTzFuaktJbzFOTmFweDdxcVFsQU1WYUVoZWZZWFRwcDlJSlEvNjQw?x-oss-process=image/format,png" alt="img"></p>
<p>改完后再打包一次即可</p>
<p>7：部署<br>部署这里，需要后端搭建好环境<br>我这里是一件搭建好的环境<br>使用<code>ftp</code>链接到服务器的根目录底下<br>我在根目录底下新建了一个文件夹<code>ChemHtml</code><br>然后将dist静态文件夹里面的内容拷贝到<code>ChemHtml</code>里面</p>
<img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0wybVlicVFjWGM3bmliMUFNeDVNUERnbVlsUzFoT0lOYUVjdDZjREgxeEg0aWF5VlJHOHlmNGliQ2cvNjQw?x-oss-process=image/format,png" alt="img"  />

<p>最后访问<br>服务器的主机ip地址我就加一下马赛克啦。</p>
<img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy81SVFpYUFJTFM1SDBYcTdWZDluaWNKdHhpYXJpYVllSUlnQ0x4eUU5YThyTFRadHJlbzNTenlJbkhmaWMxNjc2NXlvOHhiWWliSjJSZ00xRjYzQ0lFSW1JdEdWdy82NDA?x-oss-process=image/format,png" alt="img"  />

<p><font color="red">注：</font>转载于：<a href="https://www.cnblogs.com/goloving/p/9147551.html" target="_blank" rel="noopener">https://www.cnblogs.com/goloving/p/9147551.html</a></p>
<hr>
<h4 id="2-正则表达式验证"><a href="#2-正则表达式验证" class="headerlink" title="2.  正则表达式验证"></a>2. <font color="#00AFF0"> 正则表达式验证</font></h4><blockquote>
<p>验证数字的正则表达式集<br>验证数字：^[0-9]<em>$<br>验证n位的数字：^\d{n}$<br>验证至少n位数字：^\d{n,}$<br>验证m-n位的数字：^\d{m,n}$<br>验证零和非零开头的数字：^(0|[1-9][0-9]</em>)$<br>验证有两位小数的正实数：^[0-9]+(.[0-9]{2})?$<br>验证有1-3位小数的正实数：^[0-9]+(.[0-9]{1,3})?$<br>验证非零的正整数：^+?[1-9][0-9]<em>$<br>验证非零的负整数：^-[1-9][0-9]</em>$<br>验证非负整数（正整数 + 0） ^\d+$<br>验证非正整数（负整数 + 0） ^((-\d+)|(0+))$<br>验证长度为3的字符：^.{3}$<br>验证由26个英文字母组成的字符串：^[A-Za-z]+$<br>验证由26个大写英文字母组成的字符串：^[A-Z]+$<br>验证由26个小写英文字母组成的字符串：^[a-z]+$<br>验证由数字和26个英文字母组成的字符串：^[A-Za-z0-9]+$<br>验证由数字、26个英文字母或者下划线组成的字符串：^\w+$<br>验证用户密码:^[a-zA-Z]\w{5,17}$ 正确格式为：以字母开头，长度在6-18之间，只能包含字符、数字和下划线。<br>验证是否含有 ^%&amp;’,;=?$&quot; 等字符：[^%&amp;’,;=?$\x22]+<br>验证汉字：<code>^[\u4e00-\u9fa5],{0,}$</code><br>验证Email地址：/^([a-zA-Z0-9]+[<em>|\</em>|.]?)<em>[a-zA-Z0-9]+@([a-zA-Z0-9]+[<em>|\</em>|.]?)</em>[a-zA-Z0-9]+.[a-zA-Z]{2,3}$/<br>验证InternetURL：^http://([\w-]+.)+[\w-]+(/[\w-./?%&amp;=]<em>)?$ ；^[a-zA-z]+://(w+(-w+)</em>)(.(w+(-w+)<em>))</em>(?S<em>)?$<br>验证电话号码：^(\d3,4\d3,4|\d{3,4}-)?\d{7,8}$：–正确格式为：XXXX-XXXXXXX，XXXX-XXXXXXXX，XXX-XXXXXXX，XXX-XXXXXXXX，XXXXXXX，XXXXXXXX。<br>验证身份证号（15位或18位数字）：^\d{15}|\d{}18$<br>验证一年的12个月：^(0?[1-9]|1[0-2])$ 正确格式为：“01”-“09”和“1”“12”<br>验证一个月的31天：^((0?[1-9])|((1|2)[0-9])|30|31)$ 正确格式为：01、09和1、31。<br>整数：^-?\d+$<br>非负浮点数（正浮点数 + 0）：^\d+(.\d+)?$<br>正浮点数 ^(([0-9]+.[0-9]</em>[1-9][0-9]<em>)|([0-9]</em>[1-9][0-9]<em>.[0-9]+)|([0-9]</em>[1-9][0-9]<em>))$<br>非正浮点数（负浮点数 + 0） ^((-\d+(.\d+)?)|(0+(.0+)?))$<br>负浮点数 ^(-(([0-9]+.[0-9]</em>[1-9][0-9]<em>)|([0-9]</em>[1-9][0-9]<em>.[0-9]+)|([0-9]</em>[1-9][0-9]*)))$ </p>
<p>浮点数 ^(-?\d+)(.\d+)?$</p>
</blockquote>
<hr>
<h4 id="3-隐藏内容但仍保持占位的css写法"><a href="#3-隐藏内容但仍保持占位的css写法" class="headerlink" title="3.  隐藏内容但仍保持占位的css写法"></a>3. <font color="#00AFF0"> 隐藏内容但仍保持占位的css写法</font></h4><blockquote>
<p>通常显示和隐藏内容都会用<code>display:block</code>和<code>display:none</code></p>
<p>如果想要保持内容的占位可以用<code>visbility:visible</code> 和<code>visiblity:hidden</code>来控制内容的显示与隐藏。</p>
</blockquote>
<hr>
<h4 id="4-如何获取Element-中时间组件el-date-picker的时间"><a href="#4-如何获取Element-中时间组件el-date-picker的时间" class="headerlink" title="4.  如何获取Element 中时间组件el-date-picker的时间"></a>4. <font color="#00AFF0"> 如何获取Element 中时间组件el-date-picker的时间</font></h4><p><code>DateTimePicker</code>日期时间选择器的<code>Attributes</code> 中有<code>value-format</code> 这个参数，我们可以通过他来设置我们需要的时间格式，如：<code>“YYYY-MM-DD HH:MM:SS”</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-date-picker</span><br><span class="line">v-model=<span class="string">"myTime"</span></span><br><span class="line">type=<span class="string">"datetime"</span></span><br><span class="line">format=<span class="string">"yyyy-MM-ddHH:mm:ss"</span></span><br><span class="line">value-format=<span class="string">"yyyy-MM-ddHH:mm:ss"</span></span><br><span class="line">placeholder=<span class="string">"选择日期"</span></span><br><span class="line">&gt;</span><br><span class="line">&lt;<span class="regexp">/el-date-picker&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/java script 代码块</span></span><br><span class="line"><span class="regexp">data()&#123;</span></span><br><span class="line"><span class="regexp">    return&#123;</span></span><br><span class="line"><span class="regexp">        myTime :null</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;,</span></span><br><span class="line"><span class="regexp">methods:&#123;</span></span><br><span class="line"><span class="regexp">  logMyDateTime&#123;</span></span><br><span class="line"><span class="regexp">   console.log(this.myTime ); </span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

<p>在<code>html</code>的<code>el-date-picker</code>的控件中加多<code>value-format</code>， 这样写就不用使用额外的方法去处理他，拿到的数据就是我们想要的</p>
<p><font color="red">注：</font>转载于：<a href="https://blog.csdn.net/withkai44/article/details/109305880" target="_blank" rel="noopener">https://blog.csdn.net/withkai44/article/details/109305880</a></p>
<hr>
<h4 id="5-vue-element-admin动态路由无限循环的解决方法"><a href="#5-vue-element-admin动态路由无限循环的解决方法" class="headerlink" title="5.  vue-element-admin动态路由无限循环的解决方法"></a>5. <font color="#00AFF0"> vue-element-admin动态路由无限循环的解决方法</font></h4><p><code>vue-element-admin</code>是一个非常好用的开源的后台管理框架,最近在用它做一个公司用的管理平台，但是公司的项目比较小，没有权限这个功能，就把<code>if (hasRoles) {next()}</code>这段给删除了，于是在路由守卫，也就是<code>permission.js</code>里面碰到了无限循环的问题。</p>
<p>为什么会出现无限循环呢?先看下代码</p>
<p><img src="https://img-blog.csdnimg.cn/2020070116031524.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3lfd194X2s=,size_16,color_FFFFFF,t_70" alt="img"></p>
<p>主要是这个<code>next({ ...to,replace : true})</code>,只要next()里面写了内容，那么，一定会重新执行<code>router.beforEach</code>方法，这个时候如果<code>hasRoles</code>如果是否的话，代码就会继续执行到<code>next({ ...to,replace : true})</code>,于是就这样无限循环了；</p>
<p>解决的话也很简单，像我这种没有权限功能的情况下，只需要在执行 await <code>store.dispatch(&#39;permission/generateRoutes2&#39;, my_routers)</code>这段代码的时候，在方法里面往<code>vuex</code>里面写入roles不就好了吗？例如:<br><img src="https://img-blog.csdnimg.cn/20200701160927688.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3lfd194X2s=,size_16,color_FFFFFF,t_70" alt="img"></p>
<p>这样，<code>vuex</code>里面不就有roles了吗？当<code>router.beforEach</code>执行到<code>if (hasRoles)</code> 的时候，<code>hasRoles</code>为true，那么代码就执行到<code>if (hasRoles) {next()}</code> 而不是执行到<code>next({ ...to,replace : true})</code>了</p>
<p><font color="red">注：</font>转载于：<a href="https://blog.csdn.net/y_w_x_k/article/details/107065764" target="_blank" rel="noopener">https://blog.csdn.net/y_w_x_k/article/details/107065764</a></p>
<hr>
<h4 id="6-vue-element-admin-——data-functions-should-return-an-object-告警"><a href="#6-vue-element-admin-——data-functions-should-return-an-object-告警" class="headerlink" title="6.   vue-element-admin ——data functions should return an object:告警"></a>6.  <font color="#00AFF0"> vue-element-admin ——data functions should return an object:告警</font></h4><p>报错内容为：</p>
<p><img src="https://img-blog.csdnimg.cn/20200618095047468.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzU2Nzg4Nw==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<p>修改的地方：</p>
<p>主要原因是路由处理跑错了，而代码直接吧错误直接打印了<br><code>/src/permission.js</code>下，<br><code>Message.error(error || &#39;Has Error&#39;)</code>修改为<code>Message.error(&#39;Has Error&#39;)</code></p>
<p>这样做只是看起来舒服点，具体问题还是要看路由出了什么问题再去修改<br><font color="red">注：</font>转载于：<a href="https://blog.csdn.net/weixin_43567887/article/details/106824177" target="_blank" rel="noopener">https://blog.csdn.net/weixin_43567887/article/details/106824177</a></p>
<hr>
<h4 id="7-关于vue-element-admin登录流程"><a href="#7-关于vue-element-admin登录流程" class="headerlink" title="7.   关于vue-element-admin登录流程"></a>7.  <font color="#00AFF0"> 关于vue-element-admin登录流程</font></h4><p>最近写了一个基于 花裤衩 大佬的模板  Vue-element-admin<br> 关于这个Vue-element-admin中的流程可能对于新的同学不是很友好，所以我准备写一下详细的流程图<br> 首先在<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fpanjiachen.github.io%2Fvue-element-admin-site%2Fzh%2Fguide%2F" target="_blank" rel="noopener">https://panjiachen.github.io/vue-element-admin-site/zh/guide/</a>里面下载自己所需要的模板</p>
<p>我们主要说一下我们怎么改成自己的接口数据</p>
<p>我们找到login页面，如果对于路由这一方面不太了解的小伙伴建议看一下手册哦~<br> 路由文件在src/router/index 文件夹下面<br> 然后我们在找到路由里面login的路径，在views/login/index.vue<br> 我们打开之后看到一个方法是 handleLogin（）</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">handleLogin() &#123;</span><br><span class="line"> <span class="comment">//这个地方我的请求参数比较多但是主要用到的还是用户名和密码，其余的是后端要求的</span></span><br><span class="line">     <span class="keyword">var</span> <span class="keyword">data</span> = &#123;</span><br><span class="line">         grant_type: <span class="string">'password'</span>,</span><br><span class="line">         username:<span class="keyword">this</span>.loginForm.username,</span><br><span class="line">         password:<span class="keyword">this</span>.loginForm.password,</span><br><span class="line">         ClientId:<span class="number">1</span>,</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">this</span>.$refs.loginForm.validate(valid =&gt; &#123;</span><br><span class="line">         <span class="keyword">if</span> (valid) &#123;</span><br><span class="line">             <span class="keyword">this</span>.loading = <span class="literal">true</span></span><br><span class="line">             <span class="keyword">this</span>.$store.dispatch(<span class="string">'user/login'</span>, <span class="keyword">data</span>).then(() =&gt; &#123;</span><br><span class="line">                 <span class="keyword">this</span>.$router.push(&#123; path: <span class="keyword">this</span>.redirect || <span class="string">'/'</span> &#125;)</span><br><span class="line">                 <span class="keyword">this</span>.loading = <span class="literal">false</span></span><br><span class="line">                 console.log(<span class="string">'请求返回值'</span>,<span class="keyword">data</span>)</span><br><span class="line">             &#125;).<span class="keyword">catch</span>(() =&gt; &#123;</span><br><span class="line">                 <span class="keyword">this</span>.loading = <span class="literal">false</span></span><br><span class="line">             &#125;)</span><br><span class="line">         &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">             console.log(<span class="string">'error submit!!'</span>)</span><br><span class="line">             <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">         &#125;</span><br><span class="line">     &#125;)</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>然后是关于验证方法的地方，很多人疑问，哎我明明输入了账号为什么还是提示空那<br> 这就到了验证阶段了还是在login页面里面，你们找一下在data里面就有哦~我根据自己的需求改了一下</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> validateUsername = <span class="function">(<span class="params">rule, value, callback</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (value==<span class="string">''</span>) &#123;</span><br><span class="line">        callback(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'请输入用户名'</span>))</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        callback()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> validatePassword = <span class="function">(<span class="params">rule, value, callback</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(value ==<span class="string">''</span>)&#123;</span><br><span class="line">            callback(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'请输入密码'</span>))</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (value.length &lt; <span class="number">6</span>) &#123;</span><br><span class="line">        callback(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'密码长度最低位6位'</span>))</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        callback()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>然后咱们来详细看一下login的请求方法</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$store.dispatch(<span class="string">'user/login'</span>, data).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br></pre></td></tr></table></figure>

<p>这一步是告诉你我调用了store下面的user里面的login方法，然后我们找到store/modules/user</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> actions = &#123;</span><br><span class="line">  <span class="comment">// user login</span></span><br><span class="line">  login(&#123; commit &#125;, userInfo) &#123;</span><br><span class="line">    <span class="keyword">var</span> datas= qs.stringify(userInfo)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">//发送了网络请求，进行了登录操作</span></span><br><span class="line">      login(datas).then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// debugger;</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'这个是请求参数'</span>,response)</span><br><span class="line">        <span class="keyword">var</span> data  = response</span><br><span class="line">        commit(<span class="string">'SET_TOKEN'</span>, data.access_token)</span><br><span class="line">        setToken(data.access_token)</span><br><span class="line">        resolve(data.access_token)</span><br><span class="line">      &#125;).catch(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(error)</span><br><span class="line">        reject(error)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<p>你以为到这里请求就结束了吗？不可能，来让我们继续往下找</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//我们看到这个页面有一个login方法，那么就说明我们登录请求放在了这里</span></span><br><span class="line"><span class="keyword">import</span> &#123; login, logout, getInfo &#125; <span class="keyword">from</span> <span class="string">'@/api/user'</span></span><br></pre></td></tr></table></figure>

<p>可以看到，所有的接口都来自api ,根据花裤衩大佬的模式，直接api目录下面找user就行</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">'@/utils/request'</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">    url: <span class="string">'token'</span>,</span><br><span class="line">    method: <span class="string">'post'</span>,</span><br><span class="line">    data</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>你以为又结束了？？？怎么可能你看那么import是干啥的对吧，咱们接着往下找在 /utils/request</p>
<p><img src="https://upload-images.jianshu.io/upload_images/14776980-f1161304bff12fee.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/442/format/webp" alt="img"></p>
<p>request是干嘛的？</p>
<p>request是封装好的axios，主要用于发送网络请求。</p>
<p>里面的东西好复杂，看不懂怎么办？</p>
<p>没关系，你只需要知道怎么拿数据就行了</p>
<p><img src="https://upload-images.jianshu.io/upload_images/14776980-2773972d05f01c69.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>
<p>注意看一下判断的那个地方，花裤衩大佬判断的是code，我根据自己的需求进行了更改</p>
<p>说了那么多，那么到底是怎么请求接口和请求数据的呢？</p>
<p><img src="https://upload-images.jianshu.io/upload_images/14776980-e0e64920681bc8fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>
<p>把这个地方换成咱们自己的地址 ，之前或裤衩大佬可不是这样写的，他还有拼接的一步那在mock里面</p>
<p><img src="https://upload-images.jianshu.io/upload_images/14776980-7cdad7c915e1202f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>
<p>找到这里之后果然是有配置呐</p>
<p>然后咱们开始修改配置</p>
<p>因为我个人需求，需要先获取token然后根据token进行登录，所以有需要的小伙伴可以参考一下</p>
<p>我相比改的比较简单，像请求接口这一块我没有使用花裤衩大佬封装的拼接，直接给过滤调了</p>
<p><img src="https://upload-images.jianshu.io/upload_images/14776980-dc975c09d658016a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1128/format/webp" alt="img"></p>
<p>打码的地方是我的数据接口你们换成自己的就可以咯</p>
<p><img src="https://upload-images.jianshu.io/upload_images/14776980-6f0cb0ac34a2aea9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>
<p>咳咳重点来了，要考的尤其是新人，headers这个是代表了http请求头</p>
<p>我把url换成了我对应的请求接口</p>
<p><img src="https://upload-images.jianshu.io/upload_images/14776980-96be5d8aeffe477d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>
<p>老规矩打码的地方换上自己的url地址</p>
<p>这个地方需要换成自己对应的数据接口地址</p>
<p><img src="https://upload-images.jianshu.io/upload_images/14776980-a77cb298693538ed.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>
<p>这样的话基本上第一个接口获取token就通了</p>
<p>如果小伙伴们没有获取用户信息的需求那么，要(敲黑板了~超凶)</p>
<p>首先让我们在/store/utils/modules/user</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">// get user info</span></span><br><span class="line">  getInfo(&#123; commit, state &#125;) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      getInfo(state.token).then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line"><span class="comment">//如果不需要的话直接把getinfo这个方法注释掉</span></span><br><span class="line"><span class="comment">//然后进行模拟数据</span></span><br><span class="line"><span class="comment">//具体数据</span></span><br><span class="line"> <span class="keyword">var</span> data= &#123;</span><br><span class="line">    roles: [<span class="string">'admin'</span>],</span><br><span class="line">    introduction: <span class="string">'I am a super administrator'</span>,</span><br><span class="line">    avatar: <span class="string">'https://wpimg.wallstcn.com/f778738c-e4f8-4870-b634-56703b4acafe.gif'</span>,</span><br><span class="line">    name: <span class="string">'Super Admin'</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> data=response.Data.UserInfo</span><br><span class="line">        <span class="keyword">if</span> (!data) &#123;</span><br><span class="line">          reject(<span class="string">'Verification failed, please Login again.'</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> &#123; LUB_Name &#125; = data</span><br><span class="line"></span><br><span class="line">        commit(<span class="string">'SET_NAME'</span>, LUB_Name)</span><br><span class="line">        <span class="comment">// commit('SET_AVATAR', avatar)</span></span><br><span class="line">        resolve(data)</span><br><span class="line">      &#125;).catch(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">        reject(error)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<p>这个请求方法和上面的那个一样，咱们在改一下api/user里面的方法接口就好了</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params">token</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> data=(<span class="string">'bearer '</span>+token)</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">    url: <span class="string">'/api/Users/UserInfo'</span>,</span><br><span class="line">    method: <span class="string">'get'</span>,</span><br><span class="line">    headers: &#123;<span class="string">'Authorization'</span>: data &#125;,      <span class="comment">//这个地方是因为我需要给http请求协议加上一个请求头</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">到这里基本上vue-elemnt-admin 的登录就大功告成了</span><br><span class="line"></span><br><span class="line">可能其中有些不足欢迎小伙伴及时补充</span><br></pre></td></tr></table></figure>

<p><font color="red">注：</font>转载于：<a href="https://www.jianshu.com/p/29c5b8cd593e" target="_blank" rel="noopener">https://www.jianshu.com/p/29c5b8cd593e</a></p>
<hr>
<h4 id="8-GET-http-192-168-0-180-8080-sockjs-node-info-t-1591789655464-net-ERR-CONNECTION-TIMED-OUT"><a href="#8-GET-http-192-168-0-180-8080-sockjs-node-info-t-1591789655464-net-ERR-CONNECTION-TIMED-OUT" class="headerlink" title="8. GET http://192.168.0.180:8080/sockjs-node/info?t=1591789655464 net::ERR_CONNECTION_TIMED_OUT"></a>8. <font color="#00AFF0">GET <a href="http://192.168.0.180:8080/sockjs-node/info?t=1591789655464" target="_blank" rel="noopener">http://192.168.0.180:8080/sockjs-node/info?t=1591789655464</a> net::ERR_CONNECTION_TIMED_OUT</font></h4><p>如果你遇到以下情况说明你来对地方了</p>
<p><img src="https://img-blog.csdnimg.cn/2020061019464222.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjQwNDg1,size_16,color_FFFFFF,t_70" alt="img"></p>
<blockquote>
<p>进入<code>/node_modules/dist/sockjs.-client/dist/sockjs.js</code></p>
<p>将1606行的<code>self.xhr.send(payload)</code>注释</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/20200610194930471.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjQwNDg1,size_16,color_FFFFFF,t_70" alt="img"></p>
<p><font color="red">注：</font>转载于：<a href="https://blog.csdn.net/qq_42240485/article/details/106673763" target="_blank" rel="noopener">https://blog.csdn.net/qq_42240485/article/details/106673763</a></p>
<hr>
<h4 id="9-关于-VUE-APP-BASE-API-的总结"><a href="#9-关于-VUE-APP-BASE-API-的总结" class="headerlink" title="9. 关于 VUE_APP_BASE_API 的总结"></a>9. <font color="#00AFF0">关于 VUE_APP_BASE_API 的总结</font></h4><ul>
<li><p>通常我们热锅只更改<code>request.js</code>里面的<code>baseURL</code>的话，那我们打包或者区分不同环境的IP地址就会很麻烦，而此项目是根据环境动态变化 API 的；首先字节的花裤衩大佬已经帮我们配置好了这些环境配置，并且他的项目也在 mock 中实现了这点，所以我们做起来也就很简单了。</p>
</li>
<li><p>在项目的文件夹中肯定有<code>.env.development</code>、<code>.env.production</code>和<code>.env.staging</code>这几个文件，第一个环境我们应该用不到，因为他是我们的开发环境；所以我们只需要注意后两个文件的意义就行了。</p>
</li>
<li><p>我们只要更改这两个文件里面对应 IP 就行了：</p>
</li>
</ul>
<blockquote>
<p><code>.env.development</code>是我们的测试环境，也就是我们所说的线上测试环境。</p>
<p><code>.env.production</code>是我们的生产环境，也就是我们所说的线上真实环境。</p>
</blockquote>
<ul>
<li>其实这里没有真正的区分具体哪里对应着哪里的环境，主要看你自己分匹配的。</li>
<li>只要注意打包命令相对应就行了，这个你可以在<code>package.json</code>配置项里找到，<code>build:xxx</code>；当然，如果你涉及的环境比较多，你也可以自己增加需要的数量。</li>
</ul>
<hr>
<h4 id="10-VUE监听路由变化的几种方式"><a href="#10-VUE监听路由变化的几种方式" class="headerlink" title="10. VUE监听路由变化的几种方式"></a>10. <font color="#00AFF0">VUE监听路由变化的几种方式</font></h4><p>VUE页面开发中，我们经常需要根据路由的变化去实现一些操作，那么如何监听路由的变化呢？当然是利用VUE中的watch，请看代码。<br><strong>一、监听路由从哪儿来到哪儿去</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">watch:&#123;</span><br><span class="line">    $route(to,<span class="keyword">from</span>)&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="keyword">from</span>.path);<span class="comment">//从哪来</span></span><br><span class="line">      <span class="built_in">console</span>.log(to.path);<span class="comment">//到哪去</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>二、监听路由变化获取新老路由信息</strong></p>
<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">watch:&#123;</span><br><span class="line">    $route:&#123;</span><br><span class="line">      handler(val,oldval)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(val);<span class="comment">//新路由信息</span></span><br><span class="line">        <span class="built_in">console</span>.log(oldval);<span class="comment">//老路由信息</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">// 深度观察监听</span></span><br><span class="line">      deep: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></p>
<p><strong>三、监听路由变化触发方法</strong></p>
<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">methods:&#123;</span><br><span class="line">  getPath()&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">1111</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">watch:&#123;</span><br><span class="line">  <span class="string">'$route'</span>:<span class="string">'getPath'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></p>
<p>四、全局监听路由<br>在<strong>app.vue</strong>的create种加入下面代码，然后进行判断</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$router.beforeEach(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(to);</span><br><span class="line">    next();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><font color="red">注：</font>转载于：<a href="https://www.cnblogs.com/shimily/articles/12345757.html" target="_blank" rel="noopener">https://www.cnblogs.com/shimily/articles/12345757.html</a></p>
<hr>
<h4 id="11-vue-element-admin路由切换到添加或编辑页面后实现侧边栏高亮（方法一）"><a href="#11-vue-element-admin路由切换到添加或编辑页面后实现侧边栏高亮（方法一）" class="headerlink" title="11. vue-element-admin路由切换到添加或编辑页面后实现侧边栏高亮（方法一）"></a>11. <font color="#00AFF0">vue-element-admin路由切换到添加或编辑页面后实现侧边栏高亮（方法一）</font></h4><p>背景：<br>使用vue-element-admin的后台管理系统。添加和编辑页面使用路由跳转的方式切换，但是切换到添加页面后，添加功能所在页面对应的侧边栏不会高亮显示。如图当点击添加或者编辑按钮以后，左侧菜单不再高亮。</p>
<p><img src="https://img-blog.csdnimg.cn/20191230164323153.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3cxNDE4ODk5NTMy,size_16,color_FFFFFF,t_70" alt="pic"></p>
<p>分析：<br>原模板中使用:default-active=”$route.path”实现侧边栏的高亮。default-active指当前激活菜单的索引。因为这里添加和编辑页面路由的path已经发生变化，所以其所在的左侧菜单不再高亮。</p>
<p>解决：</p>
<p>(1) route 的 index.js 中给需要改变高亮的路由（添加和编辑页面）增加 guidePath 和 jumpPath 字段，guidePath 就是一个状态变量，这里可以表示当前路由高亮指向不是本身，jumpPath 表示高亮指向的路由。</p>
<p><img src="https://img-blog.csdnimg.cn/20191230164843407.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3cxNDE4ODk5NTMy,size_16,color_FFFFFF,t_70" alt="批次"></p>
<p>(2) 在侧边栏组件SidebarItem中修改 default-active属性。</p>
<p><img src="https://img-blog.csdnimg.cn/20191230165107864.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3cxNDE4ODk5NTMy,size_16,color_FFFFFF,t_70" alt="pic3"></p>
<p>侧边栏组件被引入根文件app.vue中只实例化一次，当我们切换路由的时候侧边栏组件并不会被重新调用，所以我们需要计算属性实时监听变化。</p>
<p>经过上面两步，点击添加按钮已经可以实现侧边栏高亮。如下：</p>
<p><img src="https://img-blog.csdnimg.cn/20191230165546424.png" alt="pic4"></p>
<p><font color="red">注：</font>转载于：<a href="https://blog.csdn.net/w1418899532/article/details/103768835" target="_blank" rel="noopener">https://blog.csdn.net/w1418899532/article/details/103768835</a></p>
<hr>
<h4 id="12-vue-element-admin-使用了hidden的路由如何让左侧高亮（方法二）"><a href="#12-vue-element-admin-使用了hidden的路由如何让左侧高亮（方法二）" class="headerlink" title="12. vue-element-admin 使用了hidden的路由如何让左侧高亮（方法二）"></a>12. <font color="#00AFF0">vue-element-admin 使用了hidden的路由如何让左侧高亮（方法二）</font></h4><p>前提:vue-element-admin中<br>使用了hidden的路由如何让错侧高亮呢？</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">path: <span class="string">'userList'</span>,</span><br><span class="line">   name: <span class="string">'userList'</span>,</span><br><span class="line">   component: <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">'@/views/user/userList'</span>),</span><br><span class="line">   meta: &#123;</span><br><span class="line">      title: <span class="string">'用户设置'</span>,</span><br><span class="line">   &#125;,</span><br><span class="line"> &#125;,</span><br><span class="line"> &#123;</span><br><span class="line">   path: <span class="string">'userInfoAdd'</span>,</span><br><span class="line">   name: <span class="string">'userInfoAdd'</span>,</span><br><span class="line">   component: <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">'@/views/user/userInfoAdd'</span>),</span><br><span class="line">   meta: &#123; </span><br><span class="line">     title: <span class="string">'新增用户'</span>,</span><br><span class="line">     activeMenu: <span class="string">'/user/userList'</span> <span class="comment">// 使父级路由高亮</span></span><br><span class="line">   &#125;,</span><br><span class="line">   hidden: <span class="literal">true</span></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p><strong>只需要在路由中的meta属性中增加一个<code>activeMenu: &#39;/user/userList’</code>指向他的父页面或者你任意想指向的页面就可以了</strong></p>
<p><font color="red">注：</font>转载于：<a href="https://blog.csdn.net/Mayflyingdancing/article/details/107671404" target="_blank" rel="noopener">https://blog.csdn.net/Mayflyingdancing/article/details/107671404</a></p>
<hr>
<h4 id="13-element-UI-upload组件上传附件格式限制"><a href="#13-element-UI-upload组件上传附件格式限制" class="headerlink" title="13. element UI upload组件上传附件格式限制"></a>13. <font color="#00AFF0">element UI upload组件上传附件格式限制</font></h4><blockquote>
<p>只要在<code>accept</code>中添加只接受的格式就行了，这样在选择本地文件的时候，没有接受的格式是不会显示在文件中的。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-upload</span><br><span class="line">   :action=<span class="string">"uploadUrl"</span></span><br><span class="line">   ref=<span class="string">"upload"</span></span><br><span class="line">   :multiple=<span class="string">"false"</span></span><br><span class="line">   :on-change=<span class="string">"fileChange"</span></span><br><span class="line">   :before-upload=<span class="string">"beforeUpload"</span></span><br><span class="line">   :on-success=<span class="string">"handleAvatarSuccess"</span></span><br><span class="line">   :on-preview=<span class="string">"file_click"</span></span><br><span class="line">   <span class="class"><span class="keyword">class</span></span>=<span class="string">"upload-demo"</span></span><br><span class="line">   list-type=<span class="string">"text"</span></span><br><span class="line">   accept=<span class="string">".jpg,.jpeg,.png,.gif,.bmp,.pdf,.JPG,.JPEG,.PBG,.GIF,.BMP,.PDF"</span></span><br><span class="line">   :file-list=<span class="string">"uploadForm.personFileList"</span></span><br><span class="line">   :auto-upload=<span class="string">"false"</span>&gt;</span><br><span class="line">   &lt;el-button size=<span class="string">"small"</span> type=<span class="string">"primary"</span>&gt;选择文件&lt;<span class="regexp">/el-button&gt;</span></span><br><span class="line"><span class="regexp">        &lt;div slot="tip" class="el-upload__tip"&gt;&lt;i class="el-icon-warning" style="color:red;margin-right:5px"&gt;&lt;/i</span>&gt;单个文件不超过<span class="number">5</span>MB&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp"> &lt;/</span>el-upload&gt;</span><br><span class="line"></span><br><span class="line">accept=<span class="string">".jpg,.jpeg,.png,.gif,.bmp,.pdf,.JPG,.JPEG,.PBG,.GIF,.BMP,.PDF"</span></span><br><span class="line"><span class="comment">//accept支持上传文件格式</span></span><br></pre></td></tr></table></figure>

<p><font color="red">注：</font>转载于：<a href="https://blog.csdn.net/github_37847992/article/details/80390673" target="_blank" rel="noopener">https://blog.csdn.net/github_37847992/article/details/80390673</a></p>
<hr>
<h4 id="14-Echarts多条折线图-y轴数值与实际值不一致的解决方法"><a href="#14-Echarts多条折线图-y轴数值与实际值不一致的解决方法" class="headerlink" title="14. Echarts多条折线图 y轴数值与实际值不一致的解决方法"></a>14. <font color="#00AFF0">Echarts多条折线图 y轴数值与实际值不一致的解决方法</font></h4><p><img src="https://img-blog.csdnimg.cn/20200527155556770.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlYl9zdGFydA==,size_16,color_FFFFFF,t_70" alt="ru在这里插入图片描述"><br>如图，折线图的实际值与Y轴数值不一致，解决办法很简单：<br><img src="https://img-blog.csdnimg.cn/20200527155741686.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlYl9zdGFydA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>将 series:[] 里的stack属性删除即可。</p>
<p><font color="red">注：</font>转载于：<a href="https://blog.csdn.net/web_start/article/details/106383673" target="_blank" rel="noopener">https://blog.csdn.net/web_start/article/details/106383673</a></p>
<hr>
<h4 id="15-element-el-select下拉框修改样式-el-select-dropdown："><a href="#15-element-el-select下拉框修改样式-el-select-dropdown：" class="headerlink" title="15. element el-select下拉框修改样式 el-select-dropdown："></a>15. <font color="#00AFF0"><strong>element el-select下拉框修改样式 el-select-dropdown：</strong></font></h4><p>element el-select下拉框修改样式 el-select-dropdown<br>修改下拉框的样式</p>
<p>想要修改el-select的样式 尝试修改css无效果，于是打开控制台发现如图所示，它们是同级的。</p>
<p>于是，又去仔细翻阅了element文档 发现 有一个popper-class属性</p>
<p>实践，如图所示</p>
<p><img src="https://img-blog.csdnimg.cn/20201029185345538.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxMjg3MTU4,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/20201029185407405.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxMjg3MTU4,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/20201029185455426.png#pic_center" alt="在这里插入图片描述"></p>
<p>注意：style中需要去掉 scoped！！！ 否则无效！</p>
<p><font color="red">注：</font>转载于：<a href="https://blog.csdn.net/qq_41287158/article/details/109366418" target="_blank" rel="noopener">https://blog.csdn.net/qq_41287158/article/details/109366418</a></p>
<hr>
<h4 id="16-element中el-table，type-’expand’展开行，-expand-change-”-“事件动态数据刷新问题："><a href="#16-element中el-table，type-’expand’展开行，-expand-change-”-“事件动态数据刷新问题：" class="headerlink" title="16. element中el-table，type=’expand’展开行，@expand-change=” “事件动态数据刷新问题：**"></a>16. <font color="#00AFF0">element中el-table，type=’expand’展开行，@expand-change=” “事件动态数据刷新问题：**</font></h4><p><strong>前言</strong></p>
<p>最近在写项目的时候，有个使用el-table内嵌动态table的功能需求，也就是table内嵌table，同时里面的table数据是动态获取的，动态获取动态展开</p>
<p><strong>问题</strong></p>
<p>按照element的table里面的方法，行属性设置了type=’expand’，也在table里面添加了@expand-change=”expandChange”时间监听展开行事件，在监听时间里面动态获取数据赋值给里面展开的table，<br>问题出现了，第一次点开没数据，第二次点开才有数据<br>①：第一次点开效果<br><img src="https://segmentfault.com/img/remote/1460000022758520" alt="在这里插入图片描述"><br>②：第二次展开数据显示出来<br><img src="https://segmentfault.com/img/remote/1460000022758521" alt="在这里插入图片描述"></p>
<p><strong>解决</strong></p>
<p>看到这个其实都知道是dom数据渲染不同步造成的（没有及时回显），那么该怎么做呢？于是开始了自我尝试以及度娘的过程，过程中发现了很多小伙伴也遇到了这样的问题，也有很多方法：<br>1：使用this.$nextTick的，<br>2：使用v-if显示隐藏内嵌table的，<br>3：:有不使用@expand-change方法—改成toggleRowExpansion控制的，<br>但是最终这些方法或多或少都有问题，当时自己也是一脸懵逼不知道咋办，</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">     中午休息的时候突然灵光一闪，既然是dom渲染的问题，为何我不先给这行数据里面加上一个我需要的数据，动态获取的数据直接丢进去，这样是不是就解决了呢？说干就干：</span><br><span class="line">     **第一步**：原来的设置不变，稍微改动一下展开行</span><br><span class="line">&lt;el-table</span><br><span class="line">      <span class="class"><span class="keyword">class</span></span>=<span class="string">"common-table"</span></span><br><span class="line">      :data=<span class="string">"tableData"</span></span><br><span class="line">      style=<span class="string">"width: 100%"</span></span><br><span class="line">      stripe</span><br><span class="line">      border</span><br><span class="line">      @expand-change=<span class="string">"expandChange"</span></span><br><span class="line">    &gt;</span><br><span class="line">      &lt;el-table-column type=<span class="string">"expand"</span>&gt;</span><br><span class="line">        &lt;template slot-scope=<span class="string">"scope"</span>&gt;</span><br><span class="line">          &lt;el-table :data=<span class="string">"scope.row.ruleItemData"</span> border stripe style=<span class="string">"width: 100%"</span>&gt;</span><br><span class="line">            &lt;el-table-column prop=<span class="string">"questioncount"</span> label=<span class="string">"试题数量"</span>&gt;&lt;<span class="regexp">/el-table-column&gt;</span></span><br><span class="line"><span class="regexp">          &lt;/</span>el-table&gt;</span><br><span class="line">        &lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=<span class="string">"regionName"</span> label=<span class="string">"地区"</span>&gt;&lt;<span class="regexp">/el-table-column&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>el-table&gt;</span><br></pre></td></tr></table></figure>

<p><strong>第二步</strong>：获取外部table表数据的时候强制追加一个数据项</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取表数据</span></span><br><span class="line">    queryData() &#123;</span><br><span class="line">      rule.selectByPage(<span class="keyword">this</span>.queryForm).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (res) &#123;</span><br><span class="line">          <span class="comment">//给每行数据强制追加一个数据项</span></span><br><span class="line">          res.content.list.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">            item.ruleItemData = [];</span><br><span class="line">          &#125;);</span><br><span class="line">          <span class="keyword">this</span>.tableData = res.content.list;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>

<p><strong>第三步</strong>：动态获取内嵌表数据，动态赋值当前行</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 展开事件----动态获取内嵌表数据</span></span><br><span class="line">    expandChange(row, expandedRows) &#123;</span><br><span class="line">      <span class="comment">// 该处是用于判断是展开还是收起行，只有展开的时候做请求，避免多次请求！</span></span><br><span class="line">      <span class="comment">// 展开的时候expandedRows有值，收起的时候为空.</span></span><br><span class="line">      <span class="keyword">if</span> (expandedRows.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        rule</span><br><span class="line">          .itemSelectByRuleID(&#123;</span><br><span class="line">            examruleid: row.id</span><br><span class="line">          &#125;)</span><br><span class="line">          .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// 遍历当前页面表</span></span><br><span class="line">            <span class="keyword">this</span>.tableData.forEach(<span class="function">(<span class="params">temp, index</span>) =&gt;</span> &#123;</span><br><span class="line">              <span class="comment">// 找到当前点击的行，把动态获取到的数据赋值进去</span></span><br><span class="line">              <span class="keyword">if</span> (temp.id === row.id) &#123;</span><br><span class="line">                <span class="keyword">this</span>.tableData[index].ruleItemData = res.content;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>这样就完美了，不论点开哪一行都是动态渲染哪一行的内嵌表数据。</p>
<p>附上精简了一下的整体代码供大家参考</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"common-page"</span>&gt;</span><br><span class="line">    &lt;el-table</span><br><span class="line">      <span class="class"><span class="keyword">class</span></span>=<span class="string">"common-table"</span></span><br><span class="line">      :data=<span class="string">"tableData"</span></span><br><span class="line">      style=<span class="string">"width: 100%"</span></span><br><span class="line">      stripe</span><br><span class="line">      border</span><br><span class="line">      @expand-change=<span class="string">"expandChange"</span></span><br><span class="line">    &gt;</span><br><span class="line">      &lt;el-table-column type=<span class="string">"expand"</span>&gt;</span><br><span class="line">        &lt;template slot-scope=<span class="string">"scope"</span>&gt;</span><br><span class="line">          &lt;el-table :data=<span class="string">"scope.row.ruleItemData"</span> border stripe style=<span class="string">"width: 100%"</span>&gt;</span><br><span class="line">            &lt;el-table-column prop=<span class="string">"questioncount"</span> label=<span class="string">"试题数量"</span>&gt;&lt;<span class="regexp">/el-table-column&gt;</span></span><br><span class="line"><span class="regexp">          &lt;/</span>el-table&gt;</span><br><span class="line">        &lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=<span class="string">"regionName"</span> label=<span class="string">"地区"</span>&gt;&lt;<span class="regexp">/el-table-column&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>el-table&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; rule &#125; <span class="keyword">from</span> <span class="string">"@/api/api"</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  data() &#123;</span><br></pre></td></tr></table></figure>

<p><font color="red">注：</font>转载于：<a href="https://segmentfault.com/a/1190000022758516" target="_blank" rel="noopener">https://segmentfault.com/a/1190000022758516</a></p>
<hr>
<h4 id="17-vue-实现-表格拖拽-包括表格嵌套表格拖拽："><a href="#17-vue-实现-表格拖拽-包括表格嵌套表格拖拽：" class="headerlink" title="17. vue 实现 表格拖拽 包括表格嵌套表格拖拽："></a>17. <font color="#00AFF0"><strong>vue 实现 表格拖拽 包括表格嵌套表格拖拽：</strong></font></h4><p>在上篇文章实现了表格嵌套表格 上移下移置顶置底的基础上（请看vue 表格嵌套表格 实现上移下移置顶置底），本篇将在此基础上实现拖拽功能。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">openDrag(row) &#123;</span><br><span class="line">  <span class="comment">//子表格展开时获取index</span></span><br><span class="line">  <span class="keyword">var</span> index = <span class="keyword">this</span>.tableData.findIndex(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> item.id === row.id;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">this</span>.setSort2(index);</span><br><span class="line">  <span class="keyword">this</span>.index = index;</span><br><span class="line">&#125;,</span><br><span class="line"> <span class="comment">//没有子集的排序</span></span><br><span class="line">setSort() &#123;</span><br><span class="line">  <span class="keyword">this</span>.sortable = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">this</span>.$nextTick(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> el = <span class="keyword">this</span>.$refs.dragTable.$el.querySelectorAll(</span><br><span class="line">      <span class="string">".el-table__body-wrapper &gt; table &gt; tbody"</span></span><br><span class="line">    )[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">this</span>.sortable = Sortable.create(el, &#123;</span><br><span class="line">      ghostClass: <span class="string">"sortable-ghost"</span>,</span><br><span class="line">      setData: <span class="function"><span class="params">dataTransfer</span> =&gt;</span> &#123;</span><br><span class="line">        dataTransfer.setData(<span class="string">"Text"</span>, <span class="string">""</span>);</span><br><span class="line">      &#125;,</span><br><span class="line">      onEnd: <span class="function"><span class="params">evt</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> temp = <span class="keyword">this</span>.tableData.splice(evt.oldIndex, <span class="number">1</span>)[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">this</span>.tableData.splice(evt.newIndex, <span class="number">0</span>, temp);</span><br><span class="line">        <span class="comment">// that.$forceUpdate();</span></span><br><span class="line">        <span class="keyword">this</span>.dragKey1 = <span class="built_in">Math</span>.random();</span><br><span class="line">        <span class="keyword">this</span>.setSort();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;,</span><br><span class="line">setSort2(index) &#123;</span><br><span class="line">  <span class="keyword">this</span>.sortable = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">this</span>.$nextTick(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">this</span>.$refs[<span class="string">"dragTable2-"</span> + index]) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> el = <span class="keyword">this</span>.$refs[<span class="string">"dragTable2-"</span> + index].$el.querySelectorAll(</span><br><span class="line">      <span class="string">".el-table__body-wrapper &gt; table &gt; tbody"</span></span><br><span class="line">    )[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">this</span>.sortable = Sortable.create(el, &#123;</span><br><span class="line">      ghostClass: <span class="string">"sortable-ghost"</span>,</span><br><span class="line">      setData: <span class="function"><span class="params">dataTransfer</span> =&gt;</span> &#123;</span><br><span class="line">        dataTransfer.setData(<span class="string">"Text"</span>, <span class="string">""</span>);</span><br><span class="line">      &#125;,</span><br><span class="line">      onEnd: <span class="function"><span class="params">evt</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"old:"</span>, evt.oldIndex);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"new:"</span>, evt.newIndex);</span><br><span class="line">        <span class="keyword">let</span> temp = <span class="keyword">this</span>.tableData[index].children.splice(</span><br><span class="line">          evt.oldIndex,</span><br><span class="line">          <span class="number">1</span></span><br><span class="line">        )[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">this</span>.tableData[index].children.splice(evt.newIndex, <span class="number">0</span>, temp);</span><br><span class="line">        <span class="keyword">this</span>.dragKey2 = <span class="built_in">Math</span>.random();</span><br><span class="line">        <span class="keyword">this</span>.setSort2();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210517174422724.gif" alt="在这里插入图片描述"></p>
<p><font color="red">注：</font>转载于：<a href="https://blog.csdn.net/qq_42581563/article/details/116915171" target="_blank" rel="noopener">https://blog.csdn.net/qq_42581563/article/details/116915171</a></p>
<hr>
<h4 id="18-vue的form表单在提交成功后置空："><a href="#18-vue的form表单在提交成功后置空：" class="headerlink" title="18. vue的form表单在提交成功后置空："></a>18. <font color="#00AFF0"><strong>vue的form表单在提交成功后置空：</strong></font></h4><p>说明 ：form表单加上属性值 ref=“form”<br>点击事件加入<code>roleManager.$refs[‘form’].resetFields()</code> (这里的<code>roleManager</code>指的是当前即<code>this</code>)</p>
<p><font color="red">注：</font>转载于：<a href="https://blog.csdn.net/myITliveAAA/article/details/100092039" target="_blank" rel="noopener">https://blog.csdn.net/myITliveAAA/article/details/100092039</a></p>
<hr>
<h4 id="19-vue-websocket实现数据实时推送以及本地测试："><a href="#19-vue-websocket实现数据实时推送以及本地测试：" class="headerlink" title="19. vue+websocket实现数据实时推送以及本地测试："></a>19. <font color="#00AFF0"><strong>vue+websocket实现数据实时推送以及本地测试：</strong></font></h4><p><strong><code>websocket</code> +<code>vue</code> 实现实时通信</strong><br><code>websocket</code>原理<br>目前，我们有许多数据需要实时获取，由于数据不断改变，之前我使用的方法是通过 <code>setInterval</code>去定时请求，但是由于服务器请求过来的数据需要一定的时间，导致一个请求还没有完成，定时器又开始了另外一个请求，导致请求堆积，然后这个请求就一直处于pending状态（可能就挂掉了），好吧，既然这种不行，那就换一种方法，采用了<code>setTimeout</code>在当前请求数据返回后，再发起新的请求，但是，实时性不是那么强了，最后再采取的<code>websocket</code>。</p>
<p><img src="https://img-blog.csdnimg.cn/20200225101120880.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMzNDI2MzI0,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>上图可以对比一下两个请求之间的区别，ajax轮循使用的是一问一答，每次建立请求后发送或者接收数据后，连接通道就自动关闭了，这样轮询次数多了，比较浪费带宽资源。</p>
<p><code>ws</code>是<code>H5</code>提供的在单个TCP协议上进行的全双工协议，就是服务器和客户端可以互相进行通信。ws只需要在完成一次握手以后，两者间久可建立持久的连接，并进行双向数据传输。</p>
<p><strong><code>vue</code>+<code>websocket</code>客户端的实现</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">mounted()&#123; </span><br><span class="line">		<span class="keyword">this</span>.initWebSocket(); <span class="comment">//页面渲染的时候，对ws进行初始化</span></span><br><span class="line">	&#125;,</span><br><span class="line">		methods:&#123;</span><br><span class="line">			initWebSocket () &#123; </span><br><span class="line">				<span class="keyword">this</span>.websock = <span class="keyword">new</span> WebSocket(<span class="string">'ws://localhost:8081'</span>);<span class="comment">//这个连接ws://固定，后面的根据自己的IP和端口进行改变，我设置监听的就是8081</span></span><br><span class="line">				<span class="keyword">this</span>.websock.onmessage = <span class="keyword">this</span>.websocketonmessage</span><br><span class="line">				<span class="keyword">this</span>.websock.onerror = <span class="keyword">this</span>.websocketonerror</span><br><span class="line">				<span class="keyword">this</span>.websock.onopen = <span class="keyword">this</span>.websocketonopen</span><br><span class="line">				<span class="keyword">this</span>.websock.onclose = <span class="keyword">this</span>.websocketclose</span><br><span class="line">			&#125;,</span><br><span class="line">			websocketonopen () &#123; <span class="comment">// 连接建立之后执行send方法发送数据，这个和自己的后端沟通好需要传什么数据，我的是要进行token验证</span></span><br><span class="line">				<span class="keyword">let</span> token = sessionStorage.getItem(<span class="string">'token'</span>); </span><br><span class="line">				<span class="keyword">let</span> data = &#123;</span><br><span class="line">					type: <span class="string">"REGISTER"</span>,</span><br><span class="line">					data: &#123;<span class="attr">token</span>:token&#125;</span><br><span class="line">				&#125;</span><br><span class="line">               <span class="comment">// this.websock.send(JSON.stringify(data));</span></span><br><span class="line">               <span class="keyword">this</span>.websock.send(<span class="string">"connection"</span>);</span><br><span class="line">			&#125;,</span><br><span class="line">			websocketonerror () &#123; <span class="comment">//连接错误</span></span><br><span class="line">				<span class="built_in">console</span>.log( <span class="string">'WebSocket连接失败'</span>)</span><br><span class="line">			&#125;,</span><br><span class="line">			websocketonmessage (e) &#123; <span class="comment">// 数据接收</span></span><br><span class="line">				<span class="built_in">console</span>.log(<span class="built_in">JSON</span>.parse(e.data));</span><br><span class="line">			&#125;,</span><br><span class="line">			websocketclose (e) &#123;  <span class="comment">// 关闭连接</span></span><br><span class="line">				<span class="built_in">console</span>.log(<span class="string">'已关闭连接'</span>, e)</span><br><span class="line">			&#125;,</span><br><span class="line">		&#125;,</span><br><span class="line">		destroyed () &#123;</span><br><span class="line">			<span class="keyword">this</span>.websock.close() <span class="comment">// 页面销毁后断开websocket连接</span></span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<p><strong><code>websocket</code>服务端的实现</strong></p>
<p>因为我们项目是前后端分离开发的，所以有些接口就需要自己来测试啦，这里就自己建立一个服务器端，来进行数据推送吧。</p>
<p>创建一个<code>server.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> WebSocket = <span class="built_in">require</span>(<span class="string">'ws'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> wss = <span class="keyword">new</span> WebSocket.Server(&#123; <span class="attr">port</span>: <span class="number">8081</span> &#125;);<span class="comment">//设置端口</span></span><br><span class="line"></span><br><span class="line">wss.on(<span class="string">'connection'</span>, <span class="function"><span class="keyword">function</span> <span class="title">connection</span>(<span class="params">ws</span>) </span>&#123;<span class="comment">//对‘conntection’这个串进行监听，当收到这个后，执行下面的操作</span></span><br><span class="line">  ws.on(<span class="string">'message'</span>, <span class="function"><span class="keyword">function</span> <span class="title">incoming</span>(<span class="params">message</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'received: %s'</span>, message);</span><br><span class="line">  &#125;);</span><br><span class="line">    </span><br><span class="line">  <span class="comment">//下面是我写的测试数据，按需取吧</span></span><br><span class="line">  <span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">let</span> j = <span class="number">0</span>;</span><br><span class="line">  setInterval(<span class="function"><span class="params">()</span>=&gt;</span>&#123; <span class="comment">//因为模拟实时推送数据，所以用了一个定时器推送</span></span><br><span class="line">    <span class="keyword">if</span>(++i &gt;= <span class="number">5</span>)&#123;</span><br><span class="line">      i = i%<span class="number">5</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> x = <span class="built_in">parseInt</span>(<span class="built_in">Math</span>.random()*<span class="number">5</span>+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">let</span> data = &#123;<span class="string">"pos_y"</span>:<span class="number">400</span>+x,<span class="string">"pos_z"</span>:<span class="number">0</span>,<span class="string">"pos_x"</span>:<span class="number">300</span>+x,<span class="string">"is_online"</span>:<span class="literal">true</span>,<span class="string">"team"</span>:<span class="string">"红队"</span>,<span class="string">"userName"</span>:<span class="string">"测试00"</span>+i,<span class="string">"userid"</span>:<span class="string">"1"</span>+i&#125;;</span><br><span class="line">     <span class="keyword">let</span> datas = &#123;<span class="string">"msg"</span>:<span class="string">"成功"</span>,<span class="string">"code"</span>:<span class="string">"000000"</span>,<span class="string">"data"</span>:data,<span class="string">"type"</span>:<span class="string">"LOCATION"</span>&#125;;</span><br><span class="line">    &#125;     </span><br><span class="line">    ws.send(<span class="built_in">JSON</span>.stringify(datas)); <span class="comment">//发送数据</span></span><br><span class="line">  &#125;,<span class="number">1000</span>);</span><br><span class="line"> </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>然后要启动服务，记得安装<code>ws</code>的包哦</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install websocket</span><br></pre></td></tr></table></figure>

<p>然后启动服务就可以了：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node server.js</span><br></pre></td></tr></table></figure>

<p>这样在连接创建成功后，就可以收到服务器推送的数据了。</p>
<p><font color="red">注：</font>转载于：<a href="https://blog.csdn.net/qq_33426324/article/details/104491306" target="_blank" rel="noopener">https://blog.csdn.net/qq_33426324/article/details/104491306</a></p>
<hr>
<h4 id="20-使用element-ui-table-expand展开行实现手风琴效果："><a href="#20-使用element-ui-table-expand展开行实现手风琴效果：" class="headerlink" title="20. 使用element-ui table expand展开行实现手风琴效果："></a>20. <font color="#00AFF0"><strong>使用element-ui table expand展开行实现手风琴效果：</strong></font></h4><p>写这篇博客的初衷：官网演示效果为点击toggle，已经展开的项不会因为其他项展开而关闭，所以延伸了下，扩展为手风琴效果。</p>
<p>根据留言反馈，新增了“修改操作栏文字”、“修改扩展栏内容”功能，完整代码传送门：<a href="https://github.com/Ele-Cat/element-expand" target="_blank" rel="noopener">https://github.com/Ele-Cat/element-expand</a></p>
<p>效果前瞻：</p>
<p><img src="https://img2020.cnblogs.com/blog/1324387/202003/1324387-20200324142009227-1312904100.gif" alt="img"></p>
<p>官网table expand地址：<a href="http://element-cn.eleme.io/#/zh-CN/component/table#zhan-kai-xing" target="_blank" rel="noopener">http://element-cn.eleme.io/#/zh-CN/component/table#zhan-kai-xing</a></p>
<p>先删减一下代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-table ref=<span class="string">"table"</span> border stripe highlight-current-row :data=<span class="string">"tableData5"</span> style=<span class="string">"width: 800px;"</span>&gt;</span><br><span class="line">    &lt;el-table-column label=<span class="string">"商品 ID"</span> prop=<span class="string">"id"</span> width=<span class="string">"100"</span>&gt;</span><br><span class="line">    &lt;<span class="regexp">/el-table-column&gt;</span></span><br><span class="line"><span class="regexp">    &lt;el-table-column label="商品名称" prop="name"&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>el-table-column&gt;</span><br><span class="line">    &lt;el-table-column label=<span class="string">"描述"</span> prop=<span class="string">"desc"</span>&gt;</span><br><span class="line">    &lt;<span class="regexp">/el-table-column&gt;</span></span><br><span class="line"><span class="regexp">    &lt;el-table-column label="操作" width="100"&gt;</span></span><br><span class="line"><span class="regexp">      &lt;template slot-scope="scope"&gt;</span></span><br><span class="line"><span class="regexp">        &lt;el-button type="text" @click="toogleExpand(scope.row)"&gt;查看详情&lt;/</span>el-button&gt;</span><br><span class="line">      &lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>el-table-column&gt;</span><br><span class="line">    &lt;el-table-column type=<span class="string">"expand"</span> width=<span class="string">"1"</span>&gt;</span><br><span class="line">      &lt;template slot-scope=<span class="string">"props"</span>&gt;</span><br><span class="line">        &lt;el-form label-position=<span class="string">"left"</span> inline <span class="class"><span class="keyword">class</span></span>=<span class="string">"demo-table-expand"</span>&gt;</span><br><span class="line">          &lt;el-form-item label=<span class="string">"商品名称"</span>&gt;</span><br><span class="line">            &lt;span&gt;&#123;&#123; props.row.name &#125;&#125;&lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp">          &lt;/</span>el-form-item&gt;</span><br><span class="line">        &lt;<span class="regexp">/el-form&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>template&gt;</span><br><span class="line">    &lt;<span class="regexp">/el-table-column&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>el-table&gt;</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">export default &#123;</span></span><br><span class="line"><span class="regexp">  data() &#123;</span></span><br><span class="line"><span class="regexp">    return &#123;</span></span><br><span class="line"><span class="regexp">      tableData5: [&#123;</span></span><br><span class="line"><span class="regexp">        id: '1',</span></span><br><span class="line"><span class="regexp">        name: '好滋好味鸡蛋仔1',</span></span><br><span class="line"><span class="regexp">        desc: '荷兰优质淡奶，奶香浓而不腻1',</span></span><br><span class="line"><span class="regexp">      &#125;, &#123;</span></span><br><span class="line"><span class="regexp">        id: '2',</span></span><br><span class="line"><span class="regexp">        name: '好滋好味鸡蛋仔2',</span></span><br><span class="line"><span class="regexp">        desc: '荷兰优质淡奶，奶香浓而不腻2',</span></span><br><span class="line"><span class="regexp">      &#125;, &#123;</span></span><br><span class="line"><span class="regexp">        id: '3',</span></span><br><span class="line"><span class="regexp">        name: '好滋好味鸡蛋仔3',</span></span><br><span class="line"><span class="regexp">        desc: '荷兰优质淡奶，奶香浓而不腻3',</span></span><br><span class="line"><span class="regexp">      &#125;, &#123;</span></span><br><span class="line"><span class="regexp">        id: '4',</span></span><br><span class="line"><span class="regexp">        name: '好滋好味鸡蛋仔4',</span></span><br><span class="line"><span class="regexp">        desc: '荷兰优质淡奶，奶香浓而不腻4',</span></span><br><span class="line"><span class="regexp">      &#125;]</span></span><br><span class="line"><span class="regexp">    &#125;;</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  methods: &#123;</span></span><br><span class="line"><span class="regexp">    toogleExpand(row) &#123;</span></span><br><span class="line"><span class="regexp">      let $table = this.$refs.table;</span></span><br><span class="line"><span class="regexp">      $table.toggleRowExpansion(row)</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">&lt;/</span>script&gt;</span><br></pre></td></tr></table></figure>



<p>后台中，我们一般会点击按钮去展开查看详情，所以我们替换箭头为“查看详情”按钮，通过<code>toggleRowExpansion</code>方法展开合闭<code>expand</code>。效果如图：</p>
<p><img src="https://img2018.cnblogs.com/blog/1324387/201903/1324387-20190315145117238-128781339.png" alt="img"></p>
<p>但是现在我们还没有实现手风琴效果，修改methods→<code>toogleExpand</code>方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">toogleExpand(row) &#123;</span><br><span class="line">  <span class="keyword">let</span> $table = <span class="keyword">this</span>.$refs.table;</span><br><span class="line">  <span class="keyword">this</span>.tableData5.map(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">    $table.toggleRowExpansion(item, <span class="literal">false</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  $table.toggleRowExpansion(row)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>table的<code>toggleRowExpansion</code>方法可以传两个参数，第一个参数传row，第二个参数传false，意思是合闭expand。我们把每行的expand关闭一次，再把对应的行打开，这样就实现了手风琴效果了。</p>
<p>新的问题，当我们点击打开了手风琴，每次都至少有一个是打开状态的，这样很明显是bug了，我们做一下让已打开行的expand合闭。</p>
<p>bug原因：当我们点击已打开的expand想关闭它时，相当于走了一遍<code>$table.toggleRowExpansion(row, false)</code>后，又走了一遍<code>$table.toggleRowExpansion(row)</code>，所以这行的expand又被打开了。我们把“合闭/打开“的expand对应的行去除“合闭“操作。</p>
<p>修复<code>toogleExpand</code>方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">toogleExpand(row) &#123;</span><br><span class="line">  <span class="keyword">let</span> $table = <span class="keyword">this</span>.$refs.table;</span><br><span class="line">  <span class="keyword">this</span>.tableData5.map(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (row.id != item.id) &#123;</span><br><span class="line">      $table.toggleRowExpansion(item, <span class="literal">false</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  $table.toggleRowExpansion(row)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>需求结束。</p>
<p>后记：有时候，后台需求会很纷繁复杂，我们在使用别人造的轮子时要多研究多思考。</p>
<p>欢迎体验由我个人开发的高颜值云开发工具小程序 <img src="https://img2018.cnblogs.com/blog/1324387/201905/1324387-20190524134827292-1343993864.png" alt="img"></p>
<p><font color="red">注：</font>转载于：<a href="https://www.cnblogs.com/e-cat/p/10532982.html" target="_blank" rel="noopener">https://www.cnblogs.com/e-cat/p/10532982.html</a></p>
<hr>
<h4 id="21-element-ui中的table记住分页多选框选中的数据："><a href="#21-element-ui中的table记住分页多选框选中的数据：" class="headerlink" title="21. element-ui中的table记住分页多选框选中的数据："></a>21. <font color="#00AFF0"><strong>element-ui中的table记住分页多选框选中的数据：</strong></font></h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> &lt;el-table</span><br><span class="line">    v-loading=<span class="string">"widgetListLoading"</span></span><br><span class="line">    ref=<span class="string">"multipleTable"</span></span><br><span class="line">    :data=<span class="string">"notAddwidgetList"</span></span><br><span class="line">    :row-key=<span class="string">"getRowKeys"</span></span><br><span class="line">    border</span><br><span class="line">    stripe</span><br><span class="line">    tooltip-effect=<span class="string">"dark"</span></span><br><span class="line">    style=<span class="string">"width: 100%"</span></span><br><span class="line">    @selection-change=<span class="string">"handleSelectionChange"</span>&gt;</span><br><span class="line">        &lt;el-table-column</span><br><span class="line">    :reserve-selection=<span class="string">"true"</span></span><br><span class="line">    type=<span class="string">"selection"</span></span><br><span class="line">    width=<span class="string">"55"</span></span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure>

<p>在method中添加这个方法: </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">getRowKeys(row) &#123;</span><br><span class="line">    <span class="keyword">return</span> row.id</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>table中的多选框，点击下一页时，需要记住上一页的数据，因此需要添加</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">:row-key=<span class="string">"getRowKeys"</span></span><br><span class="line"></span><br><span class="line">:reserve-selection=<span class="string">"true"</span></span><br><span class="line"></span><br><span class="line">getRowKeys(row) &#123;</span><br><span class="line">	<span class="keyword">return</span> row.id</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>在完成后，需要清空选中的</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$refs.multipleTable.clearSelection()</span><br></pre></td></tr></table></figure>

<p><font color="red">注：</font>转载于：<a href="https://blog.csdn.net/u011662320/article/details/88344295" target="_blank" rel="noopener">https://blog.csdn.net/u011662320/article/details/88344295</a></p>
<hr>
<h4 id="22-封装WebSocket（建立链接、主动关闭）："><a href="#22-封装WebSocket（建立链接、主动关闭）：" class="headerlink" title="22. 封装WebSocket（建立链接、主动关闭）："></a>22. <font color="#00AFF0"><strong>封装WebSocket（建立链接、主动关闭）：</strong></font></h4><h5 id="一丶前言"><a href="#一丶前言" class="headerlink" title="一丶前言"></a>一丶前言</h5><p>　　近期项目里需做一个在线聊天功能，就想要在对话的时候建立socket链接。又因为聊天只是其中一个部分，在它外面还有一些全局的消息通知需要接收，因此也需要建立socket链接。在该项目里不仅一处用到了socket，就想着封装一个socket的，可以在项目里调用。</p>
<p>之前也用过一次<code>websocket</code>，但那次是直接用的<code>socke.io</code>，我也忘了这次为啥没有继续使用，对这个也一知半解，似懂非懂，先一点一点记起来。具体是介绍和解释就不写了，主要写几个帮助理解的部分。</p>
<h5 id="二、HTML5-WebSocket"><a href="#二、HTML5-WebSocket" class="headerlink" title="二、HTML5 WebSocket"></a>二、<code>HTML5 WebSocket</code></h5><p>　　<code>WebSocket</code> 是 <code>HTML5</code> 开始提供的一种在单个 TCP 连接上进行全双工通讯的协议。</p>
<p>2.1、创建<code>WebSocket</code>实例</p>
<p>　<code>WebSocket</code> 对象作为一个构造函数，用于新建<code>WebSocket</code>实例。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Socket = <span class="keyword">new</span> WebSocket(url,[protocol]);</span><br></pre></td></tr></table></figure>

<p>　　以上代码用于创建 <code>WebSocket</code> 对象,其中的第一个参数 <code>url</code>, 即为指定连接的 URL。第二个参数 protocol 是可选的，指定了可接受的子协议。一般来说，大多没有具体要求的，就只用写<code>url</code>即可。</p>
<p>2.2<code>websocket</code>属性</p>
<p><code>例如：var ws = new WebSocket(&#39;ws://1xx.xxx.xxx.xxx:8080/ws&#39;);</code>打印出创建的socket对象，内容如下，这些也正是<code>wensocket</code>的属性。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">　　binaryType: <span class="string">"blob"</span>                    <span class="comment">//返回websocket连接所传输二进制数据的类型，如果传输的是Blob类型的数据,则为"blob"，如果传输的是Arraybuffer类型的数据，则为"arraybuffer"</span></span><br><span class="line">　　bufferedAmount: <span class="number">0</span>　　　　　　　　　　　　 <span class="comment">//为只读属性，用于返回已经被send()方法放入队列中但还没有被发送到网络中的数据的字节数。</span></span><br><span class="line">　　extensions: <span class="string">""</span></span><br><span class="line">　　onclose: ƒ ()　　　　　　　　　　　　　　　<span class="comment">//连接关闭时触发</span></span><br><span class="line">　　onerror: ƒ ()　　　　　　　　　　　　　　　<span class="comment">//通信发生错误时触发</span></span><br><span class="line">　　onmessage: ƒ (e)　　　　　　　　　　　　  <span class="comment">//客户端接收服务端数据时触发,e为接受的数据对象</span></span><br><span class="line">　　onopen: ƒ ()　　　　　　　　　　　　　　　 <span class="comment">//连接建立时触发</span></span><br><span class="line">　　protocol: <span class="string">""</span>　　　　　　　　　　　　　　　　 <span class="comment">//用于返回服务器端选中的子协议的名字；这是一个在创建websocket对象时，在参数protocols中指定的字符串。</span></span><br><span class="line">　　readyState: <span class="number">1</span>　　　　　　　　　　　　　　　 <span class="comment">//返回值为当前websocket的链接状态</span></span><br><span class="line">　　url: <span class="string">"ws://1xx.xxx.xxx.xxx:8080/ws"</span>    <span class="comment">//返回值为当构造函数创建WebSocket实例对象时URL的绝对路径。</span></span><br></pre></td></tr></table></figure>

<p>所有属性讲解清单：<a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSocket" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/API/WebSocket</a></p>
<p> 2.3 <code>websocket</code>属性之<code>readyState</code></p>
<p>　　<code>readyState</code>返回当前<code>websocket</code>的链接状态，共有4种。可根据具体项目的需求来利用此状态，写对应的需求。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CONNECTING：值为<span class="number">0</span>，表示正在连接。</span><br><span class="line">OPEN：      值为<span class="number">1</span>，表示连接成功，可以通信了。</span><br><span class="line">CLOSING：   值为<span class="number">2</span>，表示连接正在关闭。</span><br><span class="line">CLOSED：    值为<span class="number">3</span>，表示连接已经关闭，或者打开连接失败。</span><br></pre></td></tr></table></figure>

<p> 2.4 <code>websocket</code>的方法</p>
<p>假定我们使用了上述代码创建的<code>websocket</code>对象，下面两个方法可以在任意socket事件中调用，根据自己项目需求而定。</p>
<p>　① <code>ws.send()</code>：使用连接发送数据，可以发送你想要发送的各种类型数据，如Blob对象、<code>ArrayBuffer</code> 对象、基本或复杂的数据类型等；</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ws.send(<span class="string">'消息'</span>);</span><br><span class="line"><span class="comment">//发送对象需要格式转换，接受数据同理</span></span><br><span class="line">ws.send(<span class="built_in">JSON</span>.stringify(data));</span><br></pre></td></tr></table></figure>

<p>　② <code>ws.close()</code> : 关闭连接，用户可以主动调取此方法，来关闭连接。</p>
<h5 id="三、封装websocket"><a href="#三、封装websocket" class="headerlink" title="三、封装websocket"></a>三、封装<code>websocket</code></h5><p>　　可在项目中定义一个<code>socket.js</code>文件，在需要建立socket的页面引入此js文件，即可在一个项目中创建多个<code>socket</code>连接。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> webSocket = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">var</span> globalCallback = <span class="literal">null</span>;<span class="comment">//定义外部接收数据的回调函数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//初始化websocket</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initWebSocket</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="string">"WebSocket"</span> <span class="keyword">in</span> <span class="built_in">window</span>) &#123;</span><br><span class="line">    webSocket = <span class="keyword">new</span> WebSocket(url);<span class="comment">//创建socket对象</span></span><br><span class="line">    <span class="built_in">console</span>.log(webSocket)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    alert(<span class="string">"该浏览器不支持websocket!"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//打开</span></span><br><span class="line">  webSocket.onopen = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    webSocketOpen();</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">//收信</span></span><br><span class="line">  webSocket.onmessage = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    webSocketOnMessage(e);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">//关闭</span></span><br><span class="line">  webSocket.onclose = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    webSocketClose();</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">//连接发生错误的回调方法</span></span><br><span class="line">  webSocket.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"WebSocket连接发生错误"</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//连接socket建立时触发</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">webSocketOpen</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (e === <span class="string">"LOGIN"</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> data = &#123;</span><br><span class="line">      type: <span class="string">"CONNECT"</span>,</span><br><span class="line">      token: sessionStorage.getItem(<span class="string">"token"</span>) || <span class="string">""</span></span><br><span class="line">    &#125;;</span><br><span class="line">    sendSock(data, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"WebSocket连接成功"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//客户端接收服务端数据时触发,e为接受的数据对象</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">webSocketOnMessage</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> data = <span class="built_in">JSON</span>.parse(e.data);<span class="comment">//根据自己的需要对接收到的数据进行格式化</span></span><br><span class="line">  globalCallback(data);<span class="comment">//将data传给在外定义的接收数据的函数，至关重要。</span></span><br><span class="line">  <span class="comment">/*在此函数中还可以继续根据项目需求来写其他东西。 比如我的项目里需要根据接收的数据来判断用户登录是否失效了，此时需要关闭此连接，跳转到登录页去。*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//发送数据</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">webSocketSend</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  webSocket.send(<span class="built_in">JSON</span>.stringify(data));<span class="comment">//在这里根据自己的需要转换数据格式</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//关闭socket</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">webSocketClose</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">//因为我建立了多个socket，所以我需要知道我关闭的是哪一个socket，就做了一些判断。</span></span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    webSocket.readyState === <span class="number">1</span> &amp;&amp;</span><br><span class="line">    webSocket.url === <span class="string">"ws://1xx.xx.xx.xxx:8088/ws"</span></span><br><span class="line">  ) &#123;</span><br><span class="line">    webSocket.close();<span class="comment">//这句话是关键，之前我忘了写，一直没有真正的关闭socket</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"对话连接已关闭"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//在其他需要socket地方调用的函数，用来发送数据及接受数据</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sendSock</span>(<span class="params">agentData, callback</span>) </span>&#123;</span><br><span class="line">  globalCallback = callback;<span class="comment">//此callback为在其他地方调用时定义的接收socket数据的函数，此关重要。</span></span><br><span class="line">  <span class="comment">//下面的判断主要是考虑到socket连接可能中断或者其他的因素，可以重新发送此条消息。</span></span><br><span class="line">  <span class="keyword">switch</span> (webSocket.readyState) &#123;</span><br><span class="line">    <span class="comment">//CONNECTING：值为0，表示正在连接。</span></span><br><span class="line">    <span class="keyword">case</span> webSocket.CONNECTING:</span><br><span class="line">      setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        webSocketSend(agentData, callback);</span><br><span class="line">      &#125;, <span class="number">1000</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="comment">//OPEN：值为1，表示连接成功，可以通信了。</span></span><br><span class="line">    <span class="keyword">case</span> webSocket.OPEN:</span><br><span class="line">      webSocketSend(agentData);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="comment">//CLOSING：值为2，表示连接正在关闭。</span></span><br><span class="line">    <span class="keyword">case</span> webSocket.CLOSING:</span><br><span class="line">      setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        webSocketSend(agentData, callback);</span><br><span class="line">      &#125;, <span class="number">1000</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="comment">//CLOSED：值为3，表示连接已经关闭，或者打开连接失败。</span></span><br><span class="line">    <span class="keyword">case</span> webSocket.CLOSED:</span><br><span class="line">      <span class="comment">// do something</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="comment">// this never happens</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//将初始化socket函数、发送（接收）数据的函数、关闭连接的函数export出去</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  initWebSocket,</span><br><span class="line">  webSocketClose,</span><br><span class="line">  sendSock</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="四、使用此socketJs文件（主要在vue项目中使用封装的socket）"><a href="#四、使用此socketJs文件（主要在vue项目中使用封装的socket）" class="headerlink" title="四、使用此socketJs文件（主要在vue项目中使用封装的socket）"></a>四、使用此<code>socketJs</code>文件<strong>（主要在<code>vue</code>项目中使用封装的<code>socket</code>）</strong></h5><p>　　因为我项目里涉及多出页面需要使用socket，所以我将此文件在main.js中，将其定义在原型上，使其在每个 Vue 的实例中均可使用。不用单独在每个页面都引入一次。</p>
<p>　　4.1、部分<code>main.js</code>代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socketApi <span class="keyword">from</span> <span class="string">"./tool/socket"</span>; <span class="comment">//找到封装的socket.js文件</span></span><br><span class="line">Vue.prototype.socketApi = socketApi; <span class="comment">//将其挂在原型上，这样 $socketApi就在所有的 Vue 实例中可用了。</span></span><br></pre></td></tr></table></figure>

<p>　　42、某一<code>vue</code>页面</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">   &lt;div&gt;在此页面使用封装的socket&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    name: <span class="string">"Message"</span>,</span><br><span class="line">    data() &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        wsUrl: <span class="string">" ws://172.16.10.140:8088/ws"</span>,<span class="comment">//定义socket连接地址</span></span><br><span class="line">        wsType: <span class="string">"CONNECT"</span></span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      <span class="comment">// 接收socket回调函数返回数据的方法</span></span><br><span class="line">      getConfigResult(res) &#123;</span><br><span class="line">       <span class="built_in">console</span>.log(res);<span class="comment">//服务端返回的数据</span></span><br><span class="line">      &#125;,</span><br><span class="line">      websocketSend(data) &#123;</span><br><span class="line">        <span class="comment">//data为要发送的数据，this.getConfigResult为回调函数，用于在此页面接收socket返回的数据。</span></span><br><span class="line">        <span class="comment">//至关重要！我一开始没写这个，就蒙了，咋才能到拿到回来的数据呢。</span></span><br><span class="line">        <span class="keyword">this</span>.socketApi.sendSock(data, <span class="keyword">this</span>.getConfigResult);</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    beforeRouteLeave(to, <span class="keyword">from</span>, next) &#123;</span><br><span class="line">      <span class="comment">//在离开此页面的时候主动关闭socket</span></span><br><span class="line">      <span class="keyword">this</span>.socketApi.webSocketClose();</span><br><span class="line">      next();</span><br><span class="line">    &#125;,</span><br><span class="line">    </span><br><span class="line">    created() &#123;</span><br><span class="line">      <span class="comment">//建立socket连接</span></span><br><span class="line">      <span class="keyword">this</span>.socketApi.initWebSocket(<span class="keyword">this</span>.wsUrl);</span><br><span class="line">      <span class="comment">//data为和后端商量好的数据格式</span></span><br><span class="line">      <span class="keyword">const</span> data = &#123;</span><br><span class="line">        type:<span class="keyword">this</span>.wsType,</span><br><span class="line">        msg: <span class="string">"说的话"</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="keyword">this</span>.websocketSend(data);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;style lang="scss" scoped&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>style&gt;</span><br></pre></td></tr></table></figure>

<h5 id="五、遇到的问题"><a href="#五、遇到的问题" class="headerlink" title="五、遇到的问题"></a>五、遇到的问题</h5><p>5.1、<strong><code>websocket Failed to execute &#39;send&#39; on &#39;WebSocket&#39;: Still in CONNECTING state</code></strong></p>
<p>　　一开始我只是初始化了socket，并没有发送消息过去。于是<code>websocket</code> 实例化后（我以为的建立成功了），就立马发送数据，就报了这个错误，说“正在连接”。其实我以为的建立成功是我看到了我在连接成功后的回调函数里打印的一句话：“<code>WebSocket</code>连接成功”，到底是什么正在连接还是连接成功我也不知道，所以需要在发送数据前，利用<code>socket.readyState</code>先判断此时的连接状态。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sendSock</span>(<span class="params">agentData, callback</span>) </span>&#123;</span><br><span class="line">  globalCallback = callback;<span class="comment">//此callback为在其他地方调用时定义的接收socket数据的函数，此关重要。</span></span><br><span class="line">  </span><br><span class="line"><span class="comment">//此处先判断socket连接状态 </span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">switch</span> (webSocket.readyState) &#123;</span><br><span class="line">    <span class="comment">//CONNECTING：值为0，表示正在连接。</span></span><br><span class="line">    <span class="keyword">case</span> webSocket.CONNECTING:</span><br><span class="line">      setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        webSocketSend(agentData, callback);</span><br><span class="line">      &#125;, <span class="number">1000</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="comment">//OPEN：值为1，表示连接成功，可以通信了。</span></span><br><span class="line">    <span class="keyword">case</span> webSocket.OPEN:</span><br><span class="line">      webSocketSend(agentData);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="comment">//CLOSING：值为2，表示连接正在关闭。</span></span><br><span class="line">    <span class="keyword">case</span> webSocket.CLOSING:</span><br><span class="line">      setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        webSocketSend(agentData, callback);</span><br><span class="line">      &#125;, <span class="number">1000</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="comment">//CLOSED：值为3，表示连接已经关闭，或者打开连接失败。</span></span><br><span class="line">    <span class="keyword">case</span> webSocket.CLOSED:</span><br><span class="line">      <span class="comment">// do something</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="comment">// this never happens</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>5.2、后端要求在建立连接的时候先发送一条数据，用于确定当前连接的状态</p>
<p>在此项目里，因为建立的socket需要有不同的连接用途，所以后端要在建立连接的时候给它发消息，确定建立socket，等此条消息发送完以后，再发送一条数据确定开始对话的状态。当时我在疑惑，我都socket还没建立，怎么给你发消息呢，我在什么时候发给你呢？</p>
<p>解决办法是在open函数里，发送一条消息过去。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">webSocketOpen</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="comment">//在此次定义好需要传过去的数据，先发送一个数据过去，data为与后端协议的数据类型</span></span><br><span class="line">    <span class="keyword">const</span> data = &#123;</span><br><span class="line">      type: <span class="string">"CONNECT"</span>,</span><br><span class="line">      token: sessionStorage.getItem(<span class="string">"token"</span>) || <span class="string">""</span></span><br><span class="line">    &#125;;</span><br><span class="line">    sendSock(data, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;);<span class="comment">//调用发送数据的函数</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"WebSocket连接成功"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>六、其他未考虑的地方</p>
<p>1、因为socket连接也会因为各种因素中断，所以有人写了“保活”：保活的原理–&gt;心跳，前端每隔一段时间发送一段约定好的message给后端，后端收到后返回一段约定好的message给前端，如果多久没收到前端就调用重连方法进行重连。详见：<a href="https://www.jianshu.com/p/a4eacaf8de17" target="_blank" rel="noopener">https://www.jianshu.com/p/a4eacaf8de17</a></p>
<p>2、关于socket.io使用介绍，<a href="https://www.cnblogs.com/dreamsqin/p/12018866.html" target="_blank" rel="noopener">https://www.cnblogs.com/dreamsqin/p/12018866.html</a></p>
<p><font color="orange">不要忘了自己为了什么前进！！！</font></p>
<p><font color="red">注：</font>转载于：<a href="https://www.cnblogs.com/songForU/p/12596029.html" target="_blank" rel="noopener">https://www.cnblogs.com/songForU/p/12596029.html</a></p>
<hr>
<h4 id="23-Vue-核心之数据劫持（一）："><a href="#23-Vue-核心之数据劫持（一）：" class="headerlink" title="23. Vue 核心之数据劫持（一）："></a>23. <font color="#00AFF0"><strong>Vue 核心之数据劫持（一）：</strong></font></h4><h5 id="前瞻"><a href="#前瞻" class="headerlink" title="前瞻"></a>前瞻</h5><p>当前前端界空前繁荣，各种框架横空出世，包括各类mvvm框架横行霸道，比如Angular、Regular、Vue、React等等，它们最大的优点就是可以实现数据绑定，再也不需要手动进行DOM操作了，它们实现的原理也基本上是脏检查或数据劫持。那么本文就以Vue框架出发，探索作者运用Object.defineProperty来实现数据劫持的奥秘（本文所选取的相关代码源自于Vue v2.0.3版本的源码）。</p>
<h5 id="回顾一下Object-defineProperty"><a href="#回顾一下Object-defineProperty" class="headerlink" title="回顾一下Object.defineProperty"></a>回顾一下<code>Object.defineProperty</code></h5><ul>
<li><p>语法</p>
<blockquote>
<p><code>Object.defineProperty(obj,prop,descriptor)</code></p>
</blockquote>
</li>
<li><p>参数</p>
<blockquote>
<p>obj: 目标对象</p>
<p>prop: 需要定义的属性或方法的名称</p>
<p>descriptor: 目标属性所拥有的特性</p>
</blockquote>
</li>
<li><p>可供定义的特性列表</p>
<blockquote>
<p>value: 属性的值</p>
<p>writable: 如果为false，属性的值就不能被重写。</p>
<p>get: 一旦目标属性被访问就会调回此方法，并将此方法的运算结果返回用户。</p>
<p>set: 一旦目标属性被赋值，就会调回此方法。</p>
<p>configurable: 如果为false，则任何尝试删除目标属性或修改属性性以下特性（writable, configurable, enumerable）的行为将被无效化。</p>
<p>enumerable: 是否能在for…in循环中遍历出来或在<code>Object.keys</code>中列举出来。</p>
</blockquote>
</li>
</ul>
<h5 id="什么是数据劫持"><a href="#什么是数据劫持" class="headerlink" title="什么是数据劫持"></a>什么是数据劫持</h5><p>通过上面对<code>Object.defineProperty</code>的介绍，我们不难发现，当我们访问或设置对象的属性的时候，都会触发相对应的函数，然后在这个函数里返回或设置属性的值。既然如此，我们当然可以在触发函数的时候动一些手脚做点我们自己想做的事情，这也就是“劫持”操作。在Vue中其实就是通过<code>Object.defineProperty</code>来劫持对象属性的<code>setter</code>和<code>getter</code>操作，并“种下”一个监听器，当数据发生变化的时候发出通知。先简单的举个例子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> data = &#123;</span><br><span class="line">    name:<span class="string">'lhl'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.keys(data).forEach(<span class="function"><span class="keyword">function</span>(<span class="params">key</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(data,key,&#123;</span><br><span class="line">        enumerable:<span class="literal">true</span>,</span><br><span class="line">        configurable:<span class="literal">true</span>,</span><br><span class="line">        <span class="keyword">get</span>:function()&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'get'</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="keyword">set</span>:function()&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'监听到数据发生了变化'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)；</span><br><span class="line">data.name <span class="comment">//控制台会打印出 “get”</span></span><br><span class="line">data.name = <span class="string">'hxx'</span> <span class="comment">//控制台会打印出 "监听到数据发生了变化"复制代码</span></span><br></pre></td></tr></table></figure>

<p>上面的这个例子可以看出，我们完全可以控制对象属性的设置和读取。在Vue中，作者在很多地方都非常巧妙的运用了<code>Object.defineProperty</code>这个方法，具体用在哪里并且它又解决了哪些问题，下面就做详细的介绍：</p>
<h5 id="监听对象属性的变化"><a href="#监听对象属性的变化" class="headerlink" title="监听对象属性的变化"></a>监听对象属性的变化</h5><p>这个应该是<code>Vue</code>敲开数据绑定的前大门，它通过<code>observe</code>每个对象的属性，添加到订阅器<code>dep</code>中，当数据发生变化的时候发出一个<code>notice</code>。 相关源代码如下：（作者采用的是<code>ES6+flow</code>写的，代码在<code>src/core/observer/index.js</code>模块里面）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">defineReactive</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  obj: Object,</span></span></span><br><span class="line"><span class="function"><span class="params">  key: string,</span></span></span><br><span class="line"><span class="function"><span class="params">  val: any,</span></span></span><br><span class="line"><span class="function"><span class="params">  customSetter?: Function</span></span></span><br><span class="line"><span class="function"><span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> dep = <span class="keyword">new</span> Dep()<span class="comment">//创建订阅对象</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> property = <span class="built_in">Object</span>.getOwnPropertyDescriptor(obj, key)<span class="comment">//获取obj对象的key属性的描述</span></span><br><span class="line">  <span class="comment">//属性的描述特性里面如果configurable为false则属性的任何修改将无效</span></span><br><span class="line">  <span class="keyword">if</span> (property &amp;&amp; property.configurable === <span class="literal">false</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// cater for pre-defined getter/setters</span></span><br><span class="line">  <span class="keyword">const</span> getter = property &amp;&amp; property.get</span><br><span class="line">  <span class="keyword">const</span> setter = property &amp;&amp; property.set</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> childOb = observe(val)<span class="comment">//创建一个观察者对象</span></span><br><span class="line">  <span class="built_in">Object</span>.defineProperty(obj, key, &#123;</span><br><span class="line">    enumerable: <span class="literal">true</span>,<span class="comment">//可枚举</span></span><br><span class="line">    configurable: <span class="literal">true</span>,<span class="comment">//可修改</span></span><br><span class="line">    <span class="keyword">get</span>: function reactiveGetter () &#123;</span><br><span class="line">      <span class="keyword">const</span> value = getter ? getter.call(obj) : val<span class="comment">//先调用默认的get方法取值</span></span><br><span class="line">      <span class="comment">//这里就劫持了get方法，也是作者一个巧妙设计，在创建watcher实例的时候，通过调用对象的get方法往订阅器dep上添加这个创建的watcher实例</span></span><br><span class="line">      <span class="keyword">if</span> (Dep.target) &#123;</span><br><span class="line">        dep.depend()</span><br><span class="line">        <span class="keyword">if</span> (childOb) &#123;</span><br><span class="line">          childOb.dep.depend()</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(value)) &#123;</span><br><span class="line">          dependArray(value)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> value<span class="comment">//返回属性值</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">set</span>: function reactiveSetter (newVal) &#123;</span><br><span class="line">      <span class="keyword">const</span> value = getter ? getter.call(obj) : val<span class="comment">//先取旧值</span></span><br><span class="line">      <span class="keyword">if</span> (newVal === value) &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">//这个是用来判断生产环境的，可以无视</span></span><br><span class="line">      <span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span> &amp;&amp; customSetter) &#123;</span><br><span class="line">        customSetter()</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (setter) &#123;</span><br><span class="line">        setter.call(obj, newVal)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        val = newVal</span><br><span class="line">      &#125;</span><br><span class="line">      childOb = observe(newVal)<span class="comment">//继续监听新的属性值</span></span><br><span class="line">      dep.notify()<span class="comment">//这个是真正劫持的目的，要对订阅者发通知了</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以上是Vue监听对象属性的变化，那么问题来了，我们经常在传递数据的时候往往不是一个对象，很有可能是一个数组，那是不是就没有办法了呢，答案显然是否则的。那么下面就看看作者是如何监听数组的变化：</p>
<h5 id="监听数组的变化"><a href="#监听数组的变化" class="headerlink" title="监听数组的变化"></a>监听数组的变化</h5><p>我们还看先看这段源码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arrayProto = <span class="built_in">Array</span>.prototype<span class="comment">//原生Array的原型</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> arrayMethods = <span class="built_in">Object</span>.create(arrayProto)</span><br><span class="line"></span><br><span class="line">;[</span><br><span class="line">  <span class="string">'push'</span>,</span><br><span class="line">  <span class="string">'pop'</span>,</span><br><span class="line">  <span class="string">'shift'</span>,</span><br><span class="line">  <span class="string">'unshift'</span>,</span><br><span class="line">  <span class="string">'splice'</span>,</span><br><span class="line">  <span class="string">'sort'</span>,</span><br><span class="line">  <span class="string">'reverse'</span></span><br><span class="line">]</span><br><span class="line">.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">method</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> original = arrayProto[method]<span class="comment">//缓存元素数组原型</span></span><br><span class="line">  <span class="comment">//这里重写了数组的几个原型方法</span></span><br><span class="line">  def(arrayMethods, method, <span class="function"><span class="keyword">function</span> <span class="title">mutator</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//这里备份一份参数应该是从性能方面的考虑</span></span><br><span class="line">    <span class="keyword">let</span> i = <span class="built_in">arguments</span>.length</span><br><span class="line">    <span class="keyword">const</span> args = <span class="keyword">new</span> <span class="built_in">Array</span>(i)</span><br><span class="line">    <span class="keyword">while</span> (i--) &#123;</span><br><span class="line">      args[i] = <span class="built_in">arguments</span>[i]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> result = original.apply(<span class="keyword">this</span>, args)<span class="comment">//原始方法求值</span></span><br><span class="line">    <span class="keyword">const</span> ob = <span class="keyword">this</span>.__ob__<span class="comment">//这里this.__ob__指向的是数据的Observer</span></span><br><span class="line">    <span class="keyword">let</span> inserted</span><br><span class="line">    <span class="keyword">switch</span> (method) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'push'</span>:</span><br><span class="line">        inserted = args</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">'unshift'</span>:</span><br><span class="line">        inserted = args</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">'splice'</span>:</span><br><span class="line">        inserted = args.slice(<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (inserted) ob.observeArray(inserted)</span><br><span class="line">    <span class="comment">// notify change</span></span><br><span class="line">    ob.dep.notify()</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"><span class="comment">//定义属性</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">def</span> (<span class="params">obj, key, val, enumerable</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">Object</span>.defineProperty(obj, key, &#123;</span><br><span class="line">    value: val,</span><br><span class="line">    enumerable: !!enumerable,</span><br><span class="line">    writable: <span class="literal">true</span>,</span><br><span class="line">    configurable: <span class="literal">true</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面的代码主要是继承了Array本身的原型方法，然后又做了劫持修改，可以发出通知。Vue在observer数据阶段会判断如果是数组的话，则修改数组的原型，这样的话，后面对数组的任何操作都可以在劫持的过程中控制。结合Vue的思想，我简单的写个小demo方便更好的理解:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arrayMethod = <span class="built_in">Object</span>.create(<span class="built_in">Array</span>.prototype);</span><br><span class="line">[<span class="string">'push'</span>,<span class="string">'shift'</span>].forEach(<span class="function"><span class="keyword">function</span>(<span class="params">method</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(arrayMethod,method,&#123;</span><br><span class="line">        value:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> i = <span class="built_in">arguments</span>.length</span><br><span class="line">            <span class="keyword">var</span> args = <span class="keyword">new</span> <span class="built_in">Array</span>(i)</span><br><span class="line">            <span class="keyword">while</span> (i--) &#123;</span><br><span class="line">              args[i] = <span class="built_in">arguments</span>[i]</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">var</span> original = <span class="built_in">Array</span>.prototype[method];</span><br><span class="line">            <span class="keyword">var</span> result = original.apply(<span class="keyword">this</span>,args);</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"已经控制了，哈哈"</span>);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;,</span><br><span class="line">        enumerable: <span class="literal">true</span>,</span><br><span class="line">        writable: <span class="literal">true</span>,</span><br><span class="line">        configurable: <span class="literal">true</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">var</span> bar = [<span class="number">1</span>,<span class="number">2</span>];</span><br><span class="line">bar.__proto__ = arrayMethod;</span><br><span class="line">bar.push(<span class="number">3</span>); <span class="comment">//控制台会打印出 “已经控制了，哈哈”;并且bar里面已经成功的添加了成员 ‘3’ 复制代码</span></span><br></pre></td></tr></table></figure>

<p>整个过程看起来好像没有什么问题，似乎Vue已经做到了完美，其实不然，Vue还是不能检测到数据项和数组长度改变的变化，例如下面的调用：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vm.items[index] = <span class="string">"xxx"</span>;</span><br><span class="line">vm.items.length = <span class="number">100</span>;</span><br></pre></td></tr></table></figure>

<p>我们尽量避免这样的调用方式，如果确实需要，作者也帮我们实现了一个$set操作，这里就不做介绍了。</p>
<h5 id="实现对象属性代理"><a href="#实现对象属性代理" class="headerlink" title="实现对象属性代理"></a>实现对象属性代理</h5><p>正常情况下我们是这样实例化一个Vue对象:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> VM = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    data:&#123;</span><br><span class="line">        name:<span class="string">'lhl'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    el:<span class="string">'#id'</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>按理说我们操作数据的时候应该是VM.data.name = ‘hxx’才对，但是作者觉得这样不够简洁，所以又通过代理的方式实现了VM.name = ‘hxx’的可能。 相关代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">proxy</span> (<span class="params">vm, key</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!isReserved(key)) &#123;</span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(vm, key, &#123;</span><br><span class="line">      configurable: <span class="literal">true</span>,</span><br><span class="line">      enumerable: <span class="literal">true</span>,</span><br><span class="line">      <span class="keyword">get</span>: function proxyGetter () &#123;</span><br><span class="line">        <span class="keyword">return</span> vm._data[key]</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="keyword">set</span>: function proxySetter (val) &#123;</span><br><span class="line">        vm._data[key] = val;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>表面上看起来我们是在操作<code>VM.name</code>，实际上还是通过<code>Object.defineProperty()</code>中的get和set方法劫持实现的。</p>
<h5 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h5><p><code>Vue</code>框架很好的利用了<code>Object.defineProperty()</code>这个方法来实现了数据的双向绑定，同时也达到了很好的模块间解耦，在日常开发中，你也可以用好这个方法来优化对象获取和修改属性方式，或者自己实现一个<code>MVVM</code>的双向数据绑定等。</p>
<p><font color="red">注：</font>转载于：<a href="https://juejin.cn/post/6844903463285948423" target="_blank" rel="noopener">https://juejin.cn/post/6844903463285948423</a></p>
<hr>
<h4 id="24-数据劫持（数据代理）（二）："><a href="#24-数据劫持（数据代理）（二）：" class="headerlink" title="24. 数据劫持（数据代理）（二）："></a>24. <font color="#00AFF0"><strong>数据劫持（数据代理）（二）：</strong></font></h4><p>定义：数据劫持，指的是在访问或者修改对象的某个属性时，通过一段代码拦截这个行为，进行额外的操作或者修改返回结果。</p>
<p>比较典型的是 <code>Object.defineProperty()</code> 和 ES2015 中新增的 <code>Proxy</code> 对象。数据劫持最著名的应用当属双向绑定，这也是一个已经被讨论烂了的面试必考题。例如 Vue 2.x 使用的是 <code>Object.defineProperty()</code>(Vue 在 3.x 版本之后改用 <code>Proxy</code> 进行实现)。</p>
<h5 id="Object-defineProperty"><a href="#Object-defineProperty" class="headerlink" title="Object.defineProperty"></a><code>Object.defineProperty</code></h5><p>Vue 的双向绑定已经升级为前端面试的必考题，原理我就不再重复了，网上一大片。简单来说就是利用 <code>Object.defineProperty()</code>，并且把内部解耦为 <code>Observer</code>, <code>Dep</code>, 并使用 <code>Watcher</code> 相连。<br> <code>Object.defineProperty()</code> 的问题主要有三个：</p>
<p><strong>1、不能监听数组的变化</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line"><span class="keyword">let</span> obj = &#123;&#125;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">'arr'</span>, &#123;</span><br><span class="line">  <span class="keyword">get</span> () &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'get arr'</span>)</span><br><span class="line">    <span class="keyword">return</span> arr</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="keyword">set</span> (newVal) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'set'</span>, newVal)</span><br><span class="line">    arr = newVal</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">obj.arr.push(<span class="number">4</span>) <span class="comment">// 只会打印 get arr, 不会打印 set</span></span><br><span class="line">obj.arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>] <span class="comment">// 这个能正常 set</span></span><br></pre></td></tr></table></figure>

<p>数组的以下几个方法不会触发 set：</p>
<ul>
<li>push</li>
<li>pop</li>
<li>shift</li>
<li>unshift</li>
<li>splice</li>
<li>sort</li>
<li>reverse<br>Vue 把这些方法定义为变异方法 (mutation method)，指的是会修改原来数组的方法。与之对应则是非变异方法 (non-mutating method)，例如 <code>filter</code>, <code>concat</code>, <code>slice</code> 等，它们都不会修改原始数组，而会返回一个新的数组。Vue 官网有相关文档讲述这个问题。</li>
</ul>
<p><strong>2、必须遍历对象的每个属性</strong><br> 使用 <code>Object.defineProperty()</code>多数要配合<code>Object.keys()</code>和遍历，于是多了一层嵌套。如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.keys(obj).forEach(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">Object</span>.defineProperty(obj, key, &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>3、必须深层遍历嵌套的对象</strong><br> 所谓的嵌套对象，是指类似</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">  info: &#123;</span><br><span class="line">    name: <span class="string">'eason'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果是这一类嵌套对象，那就必须逐层遍历，直到把每个对象的每个属性都调用 Object.defineProperty() 为止。 Vue 的源码中就能找到这样的逻辑 (叫做 walk 方法)。</p>
<h5 id="Proxy"><a href="#Proxy" class="headerlink" title="Proxy"></a>Proxy</h5><p>在数据劫持这个问题上，Proxy 可以被认为是 <code>Object.defineProperty()</code> 的升级版。外界对某个对象的访问，都必须经过这层拦截。因此它是针对 整个对象，而不是 对象的某个属性，所以也就不需要对 keys 进行遍历。这解决了上述 <code>Object.defineProperty()</code> 的第二个问题。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">  name: <span class="string">'Eason'</span>,</span><br><span class="line">  age: <span class="number">30</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> handler = &#123;</span><br><span class="line">  <span class="keyword">get</span> (target, key, receiver) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'get'</span>, key)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Reflect</span>.get(target, key, receiver)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="keyword">set</span> (target, key, value, receiver) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'set'</span>, key, value)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Reflect</span>.set(target, key, value, receiver)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(obj, handler)</span><br><span class="line">proxy.name = <span class="string">'Zoe'</span> <span class="comment">// set name Zoe</span></span><br><span class="line">proxy.age = <span class="number">18</span> <span class="comment">// set age 18</span></span><br></pre></td></tr></table></figure>

<h5 id="一道面试题"><a href="#一道面试题" class="headerlink" title="一道面试题"></a>一道面试题</h5><blockquote>
<p>什么样的 a 可以满足 (a === 1 &amp;&amp; a === 2 &amp;&amp; a === 3) === true 呢？(注意是 3 个 =，也就是严格相等)</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.defineProperty(<span class="built_in">window</span>, <span class="string">'a'</span>, &#123;</span><br><span class="line">  <span class="keyword">get</span> () &#123;</span><br><span class="line">    current++</span><br><span class="line">    <span class="keyword">return</span> current</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(a === <span class="number">1</span> &amp;&amp; a === <span class="number">2</span> &amp;&amp; a === <span class="number">3</span>) <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p><font color="red">注：</font>转载于：<a href="https://www.jianshu.com/p/87a1ff1d7a3c" target="_blank" rel="noopener">https://www.jianshu.com/p/87a1ff1d7a3c</a></p>
<hr>
<h4 id="25-element-ui-table-span-method（行合并）："><a href="#25-element-ui-table-span-method（行合并）：" class="headerlink" title="25. element-ui table :span-method（行合并）："></a>25. <font color="#00AFF0"><strong>element-ui table :span-method（行合并）：</strong></font></h4><p>  element-ui官网中关于行合并的例子是根据行号进行合并的，这显然不符合我们日常开发需求，因为通常我们table中的数据都是动态生成的，所以需要做一些修改。我们首先解读一下官网实例中的各参数的意义：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (columnIndex === <span class="number">0</span>) &#123;    <span class="comment">//用于设置要合并的列</span></span><br><span class="line">    <span class="keyword">if</span> (rowIndex % <span class="number">2</span> === <span class="number">0</span>) &#123;   <span class="comment">//用于设置合并开始的行号</span></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            rowspan: <span class="number">2</span>,　　　　　<span class="comment">//合并的行数</span></span><br><span class="line">            colspan: <span class="number">1</span>          <span class="comment">//合并的列数，设为０则直接不显示</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            rowspan: <span class="number">0</span>,</span><br><span class="line">            colspan: <span class="number">0</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<pre><code>研究这个例子后不难发现，实现合并行的方法其实在每一行数据渲染的时候都会执行，只不过在渲染过程中我们设置了它合并的行数和列数，以得到不同的效果。所以我们需要生成一个与行数相同的数组记录每一行设置的合并数。处理过程如下：</code></pre><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">getSpanArr(data) &#123;　</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; data.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i === <span class="number">0</span>) &#123;</span><br><span class="line">              <span class="keyword">this</span>.spanArr.push(<span class="number">1</span>);</span><br><span class="line">              <span class="keyword">this</span>.pos = <span class="number">0</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// 判断当前元素与上一个元素是否相同</span></span><br><span class="line">    <span class="keyword">if</span> (data[i].name === data[i - <span class="number">1</span>].name) &#123;</span><br><span class="line">                <span class="keyword">this</span>.spanArr[<span class="keyword">this</span>.pos] += <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">this</span>.spanArr.push(<span class="number">0</span>);</span><br><span class="line">              &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">this</span>.spanArr.push(<span class="number">1</span>);</span><br><span class="line">                <span class="keyword">this</span>.pos = i;</span><br><span class="line">              &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>​        data就是我们从后台拿到的数据，通常是一个数组；<code>spanArr</code>是一个空的数组，用于存放每一行记录的合并数；<code>pos</code>是<code>spanArr</code>的索引。上述代码意思是：如果是第一条记录（索引为０），向数组中加入１，并设置索引位置；如果不是第一条记录，则判断它与前一条记录是否相等，如果相等，则向<code>spanArr</code>中添入元素０，并将前一位元素＋１，表示合并行数＋１，以此往复，得到所有行的合并数，０即表示该行不显示。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cellMerge(&#123; row, column, rowIndex, columnIndex &#125;) &#123;</span><br><span class="line">      <span class="keyword">if</span> (columnIndex === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> _row = <span class="keyword">this</span>.spanArr[rowIndex];</span><br><span class="line">            <span class="keyword">const</span> _col = _row &gt; <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                  rowspan: _row,</span><br><span class="line">                  colspan: _col</span><br><span class="line">            &#125;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>然后根据得到的数组<code>spanArr</code>对表格进行合并渲染，并绑定合并方法</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-table</span><br><span class="line">      border</span><br><span class="line">      :data=<span class="string">"tableData"</span></span><br><span class="line">      style=<span class="string">"width: 100%;max-height: 160px;overflow: auto"</span></span><br><span class="line">      :span-method=<span class="string">"cellMerge"</span>&gt;</span><br><span class="line">    ......</span><br><span class="line">&lt;<span class="regexp">/el-table&gt;</span></span><br></pre></td></tr></table></figure>

<p>效果图如下：</p>
<p>​           <img src="https://img-blog.csdn.net/20180620104650848?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI5NDY4NTcz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="img"></p>
<p>注：后台获取数据的时候根据要在前台进行合并的字段进行排序，使要合并的字段值相同的记录依次相邻。</p>
<p><font color="red">注：</font>转载于：<a href="https://blog.csdn.net/qq_29468573/article/details/80742646" target="_blank" rel="noopener">https://blog.csdn.net/qq_29468573/article/details/80742646</a></p>
<hr>
<h4 id="26-forEach-is-not-a-function："><a href="#26-forEach-is-not-a-function：" class="headerlink" title="26. forEach is not a function："></a>26. <font color="#00AFF0"><strong>forEach is not a function：</strong></font></h4><p>问题：获取<code>html dom</code>，然后遍历<code>dom</code>时，报错 <code>tabList.forEach is not a function</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> tabList = <span class="built_in">document</span>.querySelectorAll(<span class="string">'.mui-tab-item'</span>);</span><br><span class="line"></span><br><span class="line">tabList.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">tabItem</span>)</span>&#123;</span><br><span class="line">	tabItem.classList.remove(<span class="string">'mui-active'</span>);</span><br><span class="line">	<span class="keyword">if</span>(tabItem.getAttribute(<span class="string">'href'</span>) === activeUrl)&#123;</span><br><span class="line">		tabItem.classList.add(<span class="string">'mui-active'</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>解决办法：加上一行代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">tabList = <span class="built_in">Array</span>.from(tabList);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> tabList = <span class="built_in">document</span>.querySelectorAll(<span class="string">'.mui-tab-item'</span>);</span><br><span class="line">tabList = <span class="built_in">Array</span>.from(tabList);</span><br><span class="line">tabList.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">tabItem</span>)</span>&#123;</span><br><span class="line">	tabItem.classList.remove(<span class="string">'mui-active'</span>);</span><br><span class="line">	<span class="keyword">if</span>(tabItem.getAttribute(<span class="string">'href'</span>) === activeUrl)&#123;</span><br><span class="line">		tabItem.classList.add(<span class="string">'mui-active'</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong><code>Array.from()</code>方法就是将一个类数组对象或者可遍历对象转换成一个真正的数组。 将类数组对象转换为真正数组</strong></p>
<p><font color="red">注：</font>转载于：<a href="https://blog.csdn.net/qq_39757382/article/details/106260319" target="_blank" rel="noopener">https://blog.csdn.net/qq_39757382/article/details/106260319</a></p>
<hr>
<h4 id="27-el-form表单验证的trigger类型："><a href="#27-el-form表单验证的trigger类型：" class="headerlink" title="27. el-form表单验证的trigger类型："></a>27. <font color="#00AFF0"><strong>el-form表单验证的trigger类型：</strong></font></h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//第一种</span></span><br><span class="line">&#123;</span><br><span class="line">	required: <span class="literal">true</span>,</span><br><span class="line">	message: <span class="string">'请输入字典项'</span>,</span><br><span class="line">	trigger: <span class="string">'blur'</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">//第二种</span></span><br><span class="line">&#123;</span><br><span class="line">	required: <span class="literal">true</span>,</span><br><span class="line">	message: <span class="string">'请输入字典项'</span>,</span><br><span class="line">	trigger: <span class="string">'change'</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">//第三种</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">	pattern: <span class="regexp">/^[A-Za-z0-9_]+$/</span>,</span><br><span class="line">	message: <span class="string">'字典项只能由 大小写字母、数字、下划线组成'</span>,</span><br><span class="line">	trigger: [<span class="string">'blur'</span>, <span class="string">'change'</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// </span></span><br><span class="line">enName: [</span><br><span class="line">  &#123;</span><br><span class="line">    required: <span class="literal">true</span>,</span><br><span class="line">    message: <span class="string">'组件英文名称'</span>,</span><br><span class="line">    trigger: <span class="string">'blur'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123; </span><br><span class="line">    pattern: <span class="regexp">/^[A-Za-z0-9_]+$/</span>,</span><br><span class="line">    message: <span class="string">'组件英文名称只能由 大小写字母、数字、下划线组成'</span>, </span><br><span class="line">    trigger: <span class="string">'blur'</span> </span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>trigger</code>类型为<code>blur</code>的功能是文本框失去焦点才会触发<br><code>trigger</code>类型为<code>change</code>的功能是文本框在输入内容时触发<br><code>trigger</code>类型也可以同时使用<code>blur</code>和<code>change</code>，功能结合上面两个的功能</p>
</blockquote>
<p><font color="red">注：</font>转载于：<a href="https://blog.csdn.net/weixin_43908123/article/details/108755594" target="_blank" rel="noopener">https://blog.csdn.net/weixin_43908123/article/details/108755594</a></p>
<hr>
<h4 id="28-Element-UI做校验进行测试控制台有黄色警告如何解决："><a href="#28-Element-UI做校验进行测试控制台有黄色警告如何解决：" class="headerlink" title="28. Element-UI做校验进行测试控制台有黄色警告如何解决："></a>28. <font color="#00AFF0"><strong>Element-UI做校验进行测试控制台有黄色警告如何解决：</strong></font></h4><p>在用element-ui做数据校验的时候，可能会遇到小的问题，比如，进行校验测试的时候控制台会出现黄色警告，虽然不影响实际效果，但是，看着还是心里不爽，哈哈</p>
<p>情况如下：<br>进行校验测试，控制台不断的警告</p>
<p><img src="https://img-blog.csdnimg.cn/20201204103838359.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyODA1NTY5,size_16,color_FFFFFF,t_70" alt="img"></p>
<p><strong>解决方案：</strong>在 node_modules 文件夹中找到如图所指的文件，将右边那行代码注释掉，然后保存刷新浏览器</p>
<p><img src="https://img-blog.csdnimg.cn/20201204104522301.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyODA1NTY5,size_16,color_FFFFFF,t_70" alt="img"></p>
<p>效果，是不是看着舒服多了：</p>
<p><img src="https://img-blog.csdnimg.cn/20201204104604840.png" alt="img"></p>
<p><font color="red">注：</font>转载于：<a href="https://blog.csdn.net/qq_42805569/article/details/110630166" target="_blank" rel="noopener">https://blog.csdn.net/qq_42805569/article/details/110630166</a></p>
<hr>
<h4 id="29-Element使用富文本编辑器TinyMCE使其支持图片上传："><a href="#29-Element使用富文本编辑器TinyMCE使其支持图片上传：" class="headerlink" title="29. Element使用富文本编辑器TinyMCE使其支持图片上传："></a>29. <font color="#00AFF0"><strong>Element使用富文本编辑器TinyMCE使其支持图片上传：</strong></font></h4><p>管理后台有一个核心功能就是富文本，市面上有很多这样的产品，在你使用过程中会发现有各种坑，本人之前使用富文本一般都选择的百度的<code>Ueditor</code>，功能强大，有人说它时间久远，已经跟不上时代的步伐，太丑了。刚好用到<a href="https://panjiachen.gitee.io/vue-element-admin-site/zh/" target="_blank" rel="noopener">vue-element-admin</a>，系统帮我们内置好了<code>Tinymce</code>，只是没有图片上传的功能，看了下文档，还挺简单的，下面我们来说下。</p>
<h5 id="默认位置"><a href="#默认位置" class="headerlink" title="默认位置"></a>默认位置</h5><p><code>vue-element-admin</code>将<code>Tinymce</code>默认放在了<code>@/components/Tinymce</code>中，如果你想更改<code>cdn</code>地址或者<code>tinymce</code>版本，可以在该组件中修改该<code>cnd</code>地址。它会通过<code>dynamicLoadScript</code>自动注入到<code>index.htm</code>l中。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// why use this cdn, detail see https://github.com/PanJiaChen/tinymce-all-in-one</span></span><br><span class="line"><span class="keyword">const</span> tinymceCDN = <span class="string">'https://cdn.jsdelivr.net/npm/tinymce-all-in-one@4.9.3/tinymce.min.js'</span></span><br></pre></td></tr></table></figure>

<h5 id="快速使用"><a href="#快速使用" class="headerlink" title="快速使用"></a>快速使用</h5><p>在你的页面引入并注册该组件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Tinymce <span class="keyword">from</span> <span class="string">'@/components/Tinymce'</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  name: <span class="string">'Spus'</span>,</span><br><span class="line">  components: &#123;</span><br><span class="line">    Tinymce</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<p>然后在你需要的位置调用该组件即可.注：代码中的content要注册在你的data中哟。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;tinymce :height=<span class="string">"300"</span> v-model=<span class="string">"content"</span> id=<span class="string">'tinymce'</span>&gt;&lt;<span class="regexp">/tinymce&gt;</span></span><br></pre></td></tr></table></figure>

<p>运行起来你的项目，如何，富文本正确显示了吧。</p>
<p>进阶</p>
<h5 id="取消菜单栏"><a href="#取消菜单栏" class="headerlink" title="取消菜单栏"></a>取消菜单栏</h5><p><code>tinymac</code>默认为我们显示了菜单栏，类似文件编辑器似得，只是个富文本，看着太难受了，先把它给取消，我们先看下不修改源码的情况下，组件是否支持参数传递修改。</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>描述</th>
<th>类型</th>
<th>默认</th>
</tr>
</thead>
<tbody><tr>
<td>id</td>
<td>组件的唯一标识符</td>
<td>String</td>
<td>默认会自动帮你生成一个id</td>
</tr>
<tr>
<td>value</td>
<td>富文本内容</td>
<td>String</td>
<td>仅监视更改第一次，设置v-model后，该属性无效</td>
</tr>
<tr>
<td>toolbar</td>
<td>富文本编辑器工具栏</td>
<td>Array</td>
<td>[]</td>
</tr>
<tr>
<td>menubar</td>
<td>富文本编辑器菜单栏</td>
<td>String</td>
<td>‘file edit insert view format table’</td>
</tr>
<tr>
<td>height</td>
<td>富文本编辑器高度</td>
<td>Number</td>
<td>360</td>
</tr>
<tr>
<td>width</td>
<td>富文本编辑器宽度</td>
<td>Number, String</td>
<td>/</td>
</tr>
</tbody></table>
<p>默认是这样的</p>
<p><img src="https://img.diandian100.cn/20210317141955.png" alt="img"></p>
<p>只需修改调用代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;tinymce :height=<span class="string">"300"</span> v-model=<span class="string">"content"</span>  menubar=<span class="string">""</span>&gt;&lt;<span class="regexp">/tinymce&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img.diandian100.cn/20210317142411.png" alt="img"></p>
<p>修改后顺眼多了</p>
<h5 id="图片上传"><a href="#图片上传" class="headerlink" title="图片上传"></a>图片上传</h5><p><code>Tinymce</code>默认只支持远程图片链接，如图：</p>
<p><img src="https://img.diandian100.cn/20210317142732.png" alt="img"></p>
<p>其实在富文本初始化的时候我们可以设置图片上传的，有两种方式，</p>
<h5 id="默认上传"><a href="#默认上传" class="headerlink" title="默认上传"></a>默认上传</h5><p>在初始化时即<code>window.tinymce.init</code>时配置上传地址，如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">initTinymce() &#123;</span><br><span class="line">    <span class="keyword">const</span> _this = <span class="keyword">this</span></span><br><span class="line">    <span class="built_in">window</span>.tinymce.init(&#123;</span><br><span class="line">        <span class="comment">//图片上传地址</span></span><br><span class="line">        images_upload_url: <span class="string">'你的服务器图片上传地址'</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个需要你后端按照<code>Tinymce</code>的传递和接收参数规定去接收和响应。</p>
<p><code>Tinymce</code>默认图片资源的请求参数为<code>file</code>，而服务端上传图片成功后响应给前端的参数中要使用<code>location</code>来存放上传成功的图片地址。</p>
<p>如果你的服务端按照以上做了修改，那么<code>Tinymce</code>图片上传已经支持了，查看前端，可以看到，除了支持原来的图片链接插入还可以上传插入了。</p>
<p><img src="https://img.diandian100.cn/20210317143536.png" alt="img"></p>
<h5 id="自定义上传"><a href="#自定义上传" class="headerlink" title="自定义上传"></a>自定义上传</h5><p>如果你的服务端已经写好了，不能修改了，只能寄希望于前端的时候就需要我们自定义上传了。</p>
<p>其参数名为：<code>images_upload_handler</code></p>
<p>将代码中的上传图片参数和成功响应参数修改为你自己的服务端设置好的参数即可。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 自定义图片上传</span></span><br><span class="line">images_upload_handler: <span class="function"><span class="keyword">function</span> (<span class="params">blobInfo, succFun, failFun</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> xhr, formData;</span><br><span class="line">    <span class="keyword">var</span> file = blobInfo.blob();<span class="comment">//转化为易于理解的file对象</span></span><br><span class="line">    xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    xhr.withCredentials = <span class="literal">false</span>;</span><br><span class="line">    xhr.open(<span class="string">'POST'</span>, <span class="string">'服务端图片上传地址'</span>);</span><br><span class="line">    xhr.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> json;</span><br><span class="line">        <span class="keyword">if</span> (xhr.status != <span class="number">200</span>) &#123;</span><br><span class="line">            failFun(<span class="string">'HTTP Error: '</span> + xhr.status);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 解析返回结果</span></span><br><span class="line">        json = <span class="built_in">JSON</span>.parse(xhr.responseText);</span><br><span class="line">        <span class="comment">// img为我们实际服务端返回的图片属性，判断有无该属性即判断图片有无成功</span></span><br><span class="line">        <span class="keyword">if</span> (!json || <span class="keyword">typeof</span> json.img != <span class="string">'string'</span>) &#123;</span><br><span class="line">            failFun(<span class="string">'Invalid JSON: '</span> + xhr.responseText);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 上传成功,携带图片地址</span></span><br><span class="line">        succFun(json.img);</span><br><span class="line">    &#125;;</span><br><span class="line">    formData = <span class="keyword">new</span> FormData();</span><br><span class="line">    <span class="comment">// 我们服务端接收的图片参数为img</span></span><br><span class="line">    formData.append(<span class="string">'img'</span>, file, file.name );<span class="comment">//此处与源文档不一样</span></span><br><span class="line">    xhr.send(formData);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h5 id="关于服务端图片上传功能"><a href="#关于服务端图片上传功能" class="headerlink" title="关于服务端图片上传功能"></a>关于服务端图片上传功能</h5><p>传统的服务端常见存储功能有静态文件夹存储、<a href="https://www.diandian100.cn/a2fff16.html?highlight=fast" target="_blank" rel="noopener">类似FastDFS分布式存储</a>、oss对象存储。现在基本上所有空间商都支持oss对象存储，其价格实惠，配置简单，读写快速等特点已经让越来越多的人选择oss了，本文服务端同样采用的是oss，这里简单放下代码。</p>
<p>本文以python为例(我们这里选择的是阿里oss，其他平台类似)，首先要安装第三方oss2模块，以下方法即返回图片的地址，在你的视图中调用，并绑定到指定的路由中，即可接收任何地方传来的图片资源。其实本站所有资源也是放在了oss上。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">def upload(file, file_name):</span><br><span class="line">		<span class="string">""</span><span class="string">"</span></span><br><span class="line"><span class="string">    上传文件至oss</span></span><br><span class="line"><span class="string">    :param file: 文件对象</span></span><br><span class="line"><span class="string">    :param file_name: 文件名，用于获取文件后缀，生成新的文件名</span></span><br><span class="line"><span class="string">    :return: 上传成功后的文件地址，失败则返回False</span></span><br><span class="line"><span class="string">    "</span><span class="string">""</span></span><br><span class="line">    # 获取阿里云oss上传配置</span><br><span class="line">    ali_oss = settings.ALI_OSS</span><br><span class="line">    auth = oss2.Auth(ali_oss.get(<span class="string">"ACCESS_KEY_ID"</span>), ali_oss.get(<span class="string">"ACCESS_KEY_SECRET"</span>))</span><br><span class="line">    # oss地域节点，如果绑定自定义域名可以填写自定义域名，但是is_cname要设为True</span><br><span class="line">    bucket = oss2.Bucket(auth, ali_oss.get(<span class="string">"END_POINT"</span>), ali_oss.get(<span class="string">"BUCKEY_NAME"</span>), is_cname=True)</span><br><span class="line"></span><br><span class="line">    # 生成随机文件名,并删除uuid4字符中的-,保存到指定的文件夹</span><br><span class="line">    img_new_name = (<span class="string">"%s%s%s"</span> % (ali_oss.get(<span class="string">"PATH_DIR"</span>), str(uuid4()), os.path.splitext(file_name)[<span class="number">-1</span>])).replace(<span class="string">"-"</span>, <span class="string">""</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        res = bucket.put_object(img_new_name, file)</span><br><span class="line">        # return res.resp.response.url</span><br><span class="line">        <span class="keyword">return</span> os.path.join(ali_oss.get(<span class="string">"END_POINT"</span>), img_new_name)</span><br><span class="line">    except Exception <span class="keyword">as</span> e:</span><br><span class="line">        logger.error(e.body)</span><br><span class="line">        <span class="keyword">return</span> False</span><br></pre></td></tr></table></figure>

<p>完整版效果如下：</p>
<p><a href="https://img.diandian100.cn/QQ20210317-145501-HD.mp4" target="_blank" rel="noopener">https://img.diandian100.cn/QQ20210317-145501-HD.mp4</a></p>
<p><video src="https://img.diandian100.cn/QQ20210317-145501-HD.mp4" preload="metadata" controls="" playsinline="" poster="https://www.diandian100.cn/2c128536.html" style="display: block; margin-left: auto; margin-right: auto; max-width: 100%; margin-bottom: 20px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"></video></p>
<h5 id="内容参考"><a href="#内容参考" class="headerlink" title="内容参考"></a>内容参考</h5><ul>
<li><a href="https://panjiachen.gitee.io/vue-element-admin-site/zh/feature/component/rich-editor.html" target="_blank" rel="noopener">https://panjiachen.gitee.io/vue-element-admin-site/zh/feature/component/rich-editor.html</a></li>
<li><a href="https://www.tiny.cloud/docs/general-configuration-guide/upload-images/" target="_blank" rel="noopener">https://www.tiny.cloud/docs/general-configuration-guide/upload-images/</a></li>
</ul>
<p><font color="red">注：</font>转载于：<a href="https://www.diandian100.cn/2c128536.html" target="_blank" rel="noopener">https://www.diandian100.cn/2c128536.html</a></p>
<hr>
<h4 id="30-修改vue-element-admin中Tinymce编辑器的图片上传路径："><a href="#30-修改vue-element-admin中Tinymce编辑器的图片上传路径：" class="headerlink" title="30. 修改vue-element-admin中Tinymce编辑器的图片上传路径："></a>30. <font color="#00AFF0"><strong>修改vue-element-admin中Tinymce编辑器的图片上传路径：</strong></font></h4><p>问题描述<br>在使用vue-admin-admin的Tinymce编辑器时，默认上传图片路径是<a href="https://httpbin.org/post。" target="_blank" rel="noopener">https://httpbin.org/post。</a><br>此地址会返回类似如下的json数据，其中包含有图片的base64编码形式。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    ......</span><br><span class="line">    <span class="string">"files"</span>: &#123;</span><br><span class="line">        <span class="string">"file"</span>: <span class="string">"data:image/jpeg;base64,/9j/4AAQSkZJR......"</span></span><br><span class="line">    &#125;, </span><br><span class="line">    ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当上传的图片很大，会导致返回的<code>base64</code>编码字符串超长，此时会明显感觉到编辑器响应缓慢。<br>同时，由于返回的图片编码字符串超长，在进行保存内容操作时，有可能会超出表字段设置的长度，导致数据库报错。此时只能重新定义表中相应字段的数据类型了。</p>
<p>代码分析<br>内容编辑页面<br>首先，查看使用<code>Tinymce</code>组件的编辑页面</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">	......</span><br><span class="line">	&lt;Tinymce ref=<span class="string">"editor"</span> v-model=<span class="string">"courseInfo.content"</span> :height=<span class="string">"400"</span> /&gt;</span><br><span class="line">	......</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">import Tinymce from '@/</span>components/Tinymce<span class="string">'</span></span><br><span class="line"><span class="string">......</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>Tinymce</code>组件<br>根据页面源码，可以找到<code>Tinymce</code>组件：<code>src/components/Tinymce/index.vue</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div :<span class="class"><span class="keyword">class</span></span>=<span class="string">"&#123;fullscreen:fullscreen&#125;"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"tinymce-container"</span> :style=<span class="string">"&#123;width:containerWidth&#125;"</span>&gt;</span><br><span class="line">        &lt;textarea :id=<span class="string">"tinymceId"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"tinymce-textarea"</span> /&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"editor-custom-btn-container"</span>&gt;</span><br><span class="line">        &lt;!-- editorImage组件--&gt;</span><br><span class="line">        &lt;editorImage color=<span class="string">"#1890ff"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"editor-upload-btn"</span> @successCBK=<span class="string">"imageSuccessCBK"</span> /&gt;</span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">import editorImage from './</span>components/EditorImage<span class="string">'</span></span><br><span class="line"><span class="string">......</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>

<p>在组件的定义中，看到<code>Tinymce</code>组件又引入了一个自定义的组件：<code>editorImage</code></p>
<p>自定义<code>EditorImage</code>组件<br>打开<code>editorImage</code>组件：<code>src/components/Tinymce/components/EditorImage.vue</code>，可找到图片上传URL：<a href="https://httpbin.org/post" target="_blank" rel="noopener">https://httpbin.org/post</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-upload</span><br><span class="line">	......</span><br><span class="line">	action=<span class="string">"https://httpbin.org/post"</span></span><br><span class="line">    &gt;</span><br><span class="line">	&lt;el-button size=<span class="string">"small"</span> type=<span class="string">"primary"</span>&gt;</span><br><span class="line">	    Click upload</span><br><span class="line">    &lt;<span class="regexp">/el-button&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>el-upload&gt;</span><br></pre></td></tr></table></figure>

<p>修改流程<br>后台设置<br>在<code>SpringBoot</code>的<code>Controller</code>添加上传方法</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@RestController</span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">FileUploadController</span> </span>&#123;</span><br><span class="line">	......</span><br><span class="line">    @ApiOperation(<span class="string">"上传图片"</span>)</span><br><span class="line">    @PostMapping(<span class="string">"/upload"</span>)</span><br><span class="line">    public ResultBean upload(@RequestParam(<span class="string">"file"</span>) MultipartFile multipartFile) &#123;</span><br><span class="line">    	FileInfo fileInfo = fileInfoService.upload(multipartFile);</span><br><span class="line">    	<span class="keyword">return</span> ResultBean.succ().data(<span class="string">"file"</span>, fileInfo);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>返回的数据格式定义</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"succ"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">"code"</span>: <span class="number">20000</span>,</span><br><span class="line">    <span class="string">"data"</span>: &#123;</span><br><span class="line">    <span class="string">"file"</span>: &#123;</span><br><span class="line">          <span class="string">"filePath"</span>: <span class="string">"2020/1030/1796c99498b96c40d8e1ef52465db642.png"</span>,</span><br><span class="line">          ......</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"message"</span>: <span class="string">"成功"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>组件&amp;页面修改<br>修改<code>EditorImage</code>组件<br><code>src/components/Tinymce/components/EditorImage.vue</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">	......</span><br><span class="line">	&lt;el-upload</span><br><span class="line">		......</span><br><span class="line">		# 更改图片上传路径</span><br><span class="line">		:action=<span class="string">"imgUploadUrl"</span></span><br><span class="line">	&gt;</span><br><span class="line">		&lt;!--这里顺便汉化一下:)--&gt;</span><br><span class="line">		&lt;el-button size=<span class="string">"small"</span> type=<span class="string">"primary"</span>&gt;点击上传&lt;<span class="regexp">/el-button&gt;</span></span><br><span class="line"><span class="regexp">	&lt;/</span>el-upload&gt;</span><br><span class="line">	......</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">......</span></span><br><span class="line"><span class="regexp">export default &#123;</span></span><br><span class="line"><span class="regexp">    ......</span></span><br><span class="line"><span class="regexp">    props: &#123;</span></span><br><span class="line"><span class="regexp">        ......</span></span><br><span class="line"><span class="regexp">        /</span><span class="regexp">/添加属性：上传URL</span></span><br><span class="line"><span class="regexp">        imgUploadUrl: &#123;</span></span><br><span class="line"><span class="regexp">            type: String,</span></span><br><span class="line"><span class="regexp">            default: ''</span></span><br><span class="line"><span class="regexp">        &#125;,</span></span><br><span class="line"><span class="regexp">        /</span><span class="regexp">/添加属性：图片服务器URL</span></span><br><span class="line"><span class="regexp">        imgBaseUrl: &#123;</span></span><br><span class="line"><span class="regexp">            type: String,</span></span><br><span class="line"><span class="regexp">            default: ''</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">    &#125;,</span></span><br><span class="line"><span class="regexp"> 	methods:&#123;</span></span><br><span class="line"><span class="regexp">		/</span><span class="regexp">/修改上传成功回调方法</span></span><br><span class="line"><span class="regexp">		handleSuccess(response, file) &#123;</span></span><br><span class="line"><span class="regexp">            const uid = file.uid</span></span><br><span class="line"><span class="regexp">            const objKeyArr = Object.keys(this.listObj)</span></span><br><span class="line"><span class="regexp">            for (let i = 0, len = objKeyArr.length; i &lt; len; i++) &#123;</span></span><br><span class="line"><span class="regexp">                if (this.listObj[objKeyArr[i]].uid === uid) &#123;</span></span><br><span class="line"><span class="regexp">                	/</span><span class="regexp">/ 重点是这里，response.data.file.filePath要与后台Controller返回的json数据结构对应</span></span><br><span class="line"><span class="regexp">                    this.listObj[objKeyArr[i]].url = this.imgBaseUrl + '/</span><span class="string">' + response.data.file.filePath</span></span><br><span class="line"><span class="string">                    this.listObj[objKeyArr[i]].hasSuccess = true</span></span><br><span class="line"><span class="string">                    return</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">		&#125;,</span></span><br><span class="line"><span class="string">		......</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<p>修改<code>Tinymce</code>组件</p>
<p><code>src/components/Tinymce/index.vue</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div :<span class="class"><span class="keyword">class</span></span>=<span class="string">"&#123;fullscreen:fullscreen&#125;"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"tinymce-container"</span> :style=<span class="string">"&#123;width:containerWidth&#125;"</span>&gt;</span><br><span class="line">        &lt;textarea :id=<span class="string">"tinymceId"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"tinymce-textarea"</span> /&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"editor-custom-btn-container"</span>&gt;</span><br><span class="line">            &lt;editorImage</span><br><span class="line">                color=<span class="string">"#1890ff"</span></span><br><span class="line">                <span class="class"><span class="keyword">class</span></span>=<span class="string">"editor-upload-btn"</span></span><br><span class="line">                <span class="comment">//将取得的图片上传URL继续传递到editorImage组件</span></span><br><span class="line">                :img-upload-url=<span class="string">"imgUploadUrl"</span></span><br><span class="line">                <span class="comment">//将取得的图片服务器URL继续传递到editorImage组件</span></span><br><span class="line">                :img-base-url=<span class="string">"imgBaseUrl"</span></span><br><span class="line">                @successCBK=<span class="string">"imageSuccessCBK"</span></span><br><span class="line">            /&gt;</span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">......</span></span><br><span class="line"><span class="regexp">export default &#123;</span></span><br><span class="line"><span class="regexp">    name: 'Tinymce',</span></span><br><span class="line"><span class="regexp">    components: &#123; editorImage &#125;,</span></span><br><span class="line"><span class="regexp">    props: &#123;</span></span><br><span class="line"><span class="regexp">        .......</span></span><br><span class="line"><span class="regexp">        /</span><span class="regexp">/添加属性：上传URL</span></span><br><span class="line"><span class="regexp">        imgUploadUrl: &#123;</span></span><br><span class="line"><span class="regexp">          type: String,</span></span><br><span class="line"><span class="regexp">          default: ''</span></span><br><span class="line"><span class="regexp">        &#125;,</span></span><br><span class="line"><span class="regexp">        /</span><span class="regexp">/添加属性：图片服务器URL</span></span><br><span class="line"><span class="regexp">        imgBaseUrl: &#123;</span></span><br><span class="line"><span class="regexp">          type: String,</span></span><br><span class="line"><span class="regexp">          default: ''</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">&lt;/</span>script&gt;</span><br></pre></td></tr></table></figure>

<p>修改内容编辑页面</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">	......</span><br><span class="line">    &lt;tinymce</span><br><span class="line">        v-model=<span class="string">"courseInfo.content"</span></span><br><span class="line">        :height=<span class="string">"300"</span></span><br><span class="line">        <span class="comment">//传入图片上传URL到tinymce组件</span></span><br><span class="line">        :img-upload-url=<span class="string">"imgUrl + '/upload'"</span></span><br><span class="line">        <span class="comment">//传入图片服务器URL到tinymce组件</span></span><br><span class="line">        :img-base-url=<span class="string">"imgUrl"</span></span><br><span class="line">    /&gt;</span><br><span class="line">    ......</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">export default &#123;</span></span><br><span class="line"><span class="regexp">    components: &#123; Tinymce &#125;,</span></span><br><span class="line"><span class="regexp">    data() &#123;</span></span><br><span class="line"><span class="regexp">        return &#123;</span></span><br><span class="line"><span class="regexp">    		......</span></span><br><span class="line"><span class="regexp">    		/</span><span class="regexp">/自定义的图片服务器URL</span></span><br><span class="line"><span class="regexp">    		imgUrl: process.env.VUE_APP_IMG_URL,</span></span><br><span class="line"><span class="regexp">    		......</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">    &#125;,</span></span><br><span class="line"><span class="regexp">    ......</span></span><br><span class="line"><span class="regexp"> &#125;</span></span><br><span class="line"><span class="regexp">&lt;/</span>script&gt;</span><br></pre></td></tr></table></figure>

<p>修改完成!<br>再次上传图片时，会上传到自己的图片服务器，并返回全路径。<br>在保存内容时，保存的就是图片的URL，不再是图片的<code>Base64</code>编码了。</p>
<p><font color="red">注：</font>转载于：<a href="https://blog.csdn.net/just4you/article/details/109388787" target="_blank" rel="noopener">https://blog.csdn.net/just4you/article/details/109388787</a></p>
<hr>
<h4 id="31-VUE-ELEMENT-ADMIN使用TINYMCE富文本编辑器："><a href="#31-VUE-ELEMENT-ADMIN使用TINYMCE富文本编辑器：" class="headerlink" title="31. VUE-ELEMENT-ADMIN使用TINYMCE富文本编辑器："></a>31. <font color="#00AFF0"><strong>VUE-ELEMENT-ADMIN使用TINYMCE富文本编辑器：</strong></font></h4><p>新手使用<code>tinymace</code>富文本编辑器的历程<br>环境：<code>vue-element-admin</code><br><strong>1、安装<code>tinymce-vue</code></strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @tinymce/tinymce-vue -S</span><br></pre></td></tr></table></figure>

<p><strong>2、下载<code>tinymce</code></strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install tinymce -S</span><br></pre></td></tr></table></figure>

<p><strong>3、下载完可以先在<code>public</code>下面建个目录<code>tinymce</code>，下载<code>tinymce</code>完成后在<code>node_modules</code>中找到 <code>tinymce/skins</code>目录，将其复制到<code>public\tinymce</code>目录下面</strong></p>
<p><img src="https://img-blog.csdnimg.cn/20200510042629546.png" alt="在这里插入图片描述"></p>
<p><strong>4、下载语言包</strong> <strong><a href="https://www.tiny.cloud/get-tiny/language-packages/" target="_blank" rel="noopener">下载地址</a></strong></p>
<p><img src="https://img-blog.csdnimg.cn/20200510042830299.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIwNjQ5MTQz,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p><strong>5、在<code>componets</code>下面新建目录（目录名：<code>tinymce</code>）</strong></p>
<p><img src="https://img-blog.csdnimg.cn/20200510043030539.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIwNjQ5MTQz,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p><strong>6、在刚刚新建的目录下面新建<code>index.vue</code>文件，并把下面的代码复制进去</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;editor id=<span class="string">"tinymce"</span> v-model=<span class="string">"value"</span> :init=<span class="string">"init"</span>&gt;&lt;<span class="regexp">/editor&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/引入基础文件：</span></span><br><span class="line"><span class="regexp">    import tinymce from 'tinymce/</span>tinymce<span class="string">'</span></span><br><span class="line"><span class="string">    import Editor from '</span>@tinymce/tinymce-vue<span class="string">'</span></span><br><span class="line"><span class="string">    import '</span>tinymce/themes/silver<span class="string">'</span></span><br><span class="line"><span class="string">    import '</span>tinymce/plugins/image<span class="string">'// 插入上传图片插件</span></span><br><span class="line"><span class="string">    import '</span>tinymce/plugins/link<span class="string">'// 插入链接</span></span><br><span class="line"><span class="string">    import '</span>tinymce/plugins/code<span class="string">'// 插入代码</span></span><br><span class="line"><span class="string">    import '</span>tinymce/plugins/preview<span class="string">'// 插入预览</span></span><br><span class="line"><span class="string">    import axios from '</span>axios<span class="string">'</span></span><br><span class="line"><span class="string">    export default &#123;</span></span><br><span class="line"><span class="string">        name: "tinymce",</span></span><br><span class="line"><span class="string">        components:&#123;</span></span><br><span class="line"><span class="string">            Editor</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        props:&#123;</span></span><br><span class="line"><span class="string">            curValue:&#123;</span></span><br><span class="line"><span class="string">                type:String,</span></span><br><span class="line"><span class="string">                default:'</span><span class="string">'</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        data()&#123;</span></span><br><span class="line"><span class="string">            return&#123;</span></span><br><span class="line"><span class="string">                init:&#123;</span></span><br><span class="line"><span class="string">                    language_url: '</span>/tinymce/langs/zh_CN.js<span class="string">',// 语言包的路径</span></span><br><span class="line"><span class="string">                    language: '</span>zh_CN<span class="string">',//语言</span></span><br><span class="line"><span class="string">                    skin_url: '</span>/tinymce/skins/ui/oxide<span class="string">',// skin路径</span></span><br><span class="line"><span class="string">                    height: 500,//编辑器高度</span></span><br><span class="line"><span class="string">                    branding: false,//是否禁用“Powered by TinyMCE”</span></span><br><span class="line"><span class="string">                    menubar: false,//顶部菜单栏显示</span></span><br><span class="line"><span class="string">                    elementpath: false,  //禁用编辑器底部的状态栏</span></span><br><span class="line"><span class="string">                    paste_data_images: true,// 允许粘贴图像</span></span><br><span class="line"><span class="string">                    plugins:['</span>image<span class="string">','</span>link<span class="string">','</span>code<span class="string">','</span>preview<span class="string">'],</span></span><br><span class="line"><span class="string">                    toolbar:['</span>formatselect | bold italic | alignleft aligncenter alignright alignjustify |bullist numlist outdent indent | lists image media table | removeformat link | code preview<span class="string">'],</span></span><br><span class="line"><span class="string">                    images_upload_handler: (blobInfo, success, failure) =&gt; &#123;</span></span><br><span class="line"><span class="string">                           let formdata = new FormData()</span></span><br><span class="line"><span class="string">						 	 formdata.set('</span>file<span class="string">', blobInfo.blob())</span></span><br><span class="line"><span class="string">						 	 //上传到服务器后要改地址</span></span><br><span class="line"><span class="string">						 	 //这个地址是我自己后台上传图片的地址，改成自己后台上传图片的地址http://localhost:8088/api/upload/img/</span></span><br><span class="line"><span class="string">						 		 axios.post('</span>http:<span class="comment">//localhost:8088/api/upload/img/', formdata).then(res =&gt; &#123;</span></span><br><span class="line">						 	<span class="comment">//上传到服务器后要改地址</span></span><br><span class="line">						 	<span class="comment">//这个地址是我图片映射路径http://localhost:8088/images/，可以用nginx</span></span><br><span class="line">						    success(<span class="string">"http://localhost:8088/images/"</span>+res.data)</span><br><span class="line">						  &#125;).catch(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">						    failure(<span class="string">'error'</span>)</span><br><span class="line">						  &#125;)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                value: <span class="keyword">this</span>.curValue</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        mounted() &#123;</span><br><span class="line">            tinymce.init(&#123;&#125;)</span><br><span class="line">        &#125;,</span><br><span class="line">        watch: &#123;</span><br><span class="line">        	<span class="comment">//动态传参</span></span><br><span class="line">            curValue(newValue) &#123;</span><br><span class="line">                <span class="keyword">this</span>.value = newValue</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//读取输入框内的数据</span></span><br><span class="line">            value(newValue) &#123;</span><br><span class="line">                <span class="keyword">this</span>.$emit(<span class="string">'input'</span>, newValue)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>7、在需要用的页面里引用模版</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">	&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"app-container"</span>&gt;</span><br><span class="line">		&lt;editor :curValue=<span class="string">"content"</span> @input=<span class="string">"newContent"</span> /&gt;</span><br><span class="line">	&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">	<span class="comment">//引入组件</span></span><br><span class="line">	<span class="keyword">import</span> Tinymce <span class="keyword">from</span> <span class="string">'@/components/tinymce/index'</span></span><br><span class="line">	<span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">	<span class="comment">//注册组件</span></span><br><span class="line">		components: &#123;</span><br><span class="line">			<span class="string">'editor'</span>: Tinymce</span><br><span class="line">		&#125;,</span><br><span class="line">		data() &#123;</span><br><span class="line">			<span class="keyword">return</span> &#123;</span><br><span class="line">					content:<span class="string">''</span></span><br><span class="line">				&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		methods: &#123;</span><br><span class="line">			newContent(val) &#123;</span><br><span class="line">				<span class="built_in">console</span>.log(val); <span class="comment">//获取输入内容</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>到此就全部结束了，如下图</strong><br><img src="https://img-blog.csdnimg.cn/20200510044402710.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIwNjQ5MTQz,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>为了方便使用后台，我把后台代码也一起粘上来，给大家做个参考。我的后台是用spring boot写的<br><strong>1、controller类</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.kmzhfw.service.FileUploadService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.multipart.MultipartFile;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 单图上传</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/api/upload"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FileUploadController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> FileUploadService fileUploadService;</span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/img"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">uploadImg</span><span class="params">(@RequestParam(<span class="string">"file"</span>)</span>MultipartFile multipartFile, HttpServletRequest request)</span>&#123;</span><br><span class="line">        String s = fileUploadService.uploadImg(multipartFile,request);</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>2、<code>service</code>（<code>FileUploadService</code>）</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.multipart.MultipartFile;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.imageio.ImageIO;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> java.awt.image.BufferedImage;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.UUID;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FileUploadService</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> List&lt;String&gt; ALL_TYPE = Arrays.asList(<span class="string">"image/jpeg"</span>, <span class="string">"image/jpg"</span>, <span class="string">"image/png"</span>, <span class="string">"image/gif"</span>);</span><br><span class="line">    <span class="comment">//这里的地址是我本地的地址，如上传到服务器后，可以下面的地址。这个地址是自己新建的文件夹，如果没有这个文件夹，图片是传不了的</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> String FILE_PATH = <span class="string">"G:\\myjava\\upload\\"</span>;</span><br><span class="line"><span class="comment">//    public final static String FILE_PATH = "/usr/upload/";</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">uploadImg</span><span class="params">(MultipartFile file, HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//准备目标路径</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//校验文件类型</span></span><br><span class="line">            String contentType = file.getContentType();</span><br><span class="line">            <span class="keyword">if</span> (!ALL_TYPE.contains(contentType)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"无效的文件类型"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//校验文件内容</span></span><br><span class="line">            BufferedImage image = ImageIO.read(file.getInputStream());</span><br><span class="line">            <span class="keyword">if</span>(image == <span class="keyword">null</span> )&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"无效的文件类型"</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            String fileName = file.getOriginalFilename();  <span class="comment">// 文件名</span></span><br><span class="line">            String suffixName = fileName.substring(fileName.lastIndexOf(<span class="string">"."</span>));  <span class="comment">// 后缀名</span></span><br><span class="line">            String newFileName = UUID.randomUUID()+suffixName;<span class="comment">//新名字</span></span><br><span class="line">            <span class="comment">//获取路径</span></span><br><span class="line"><span class="comment">//            String rootPath = request.getSession().getServletContext().getRealPath("/");</span></span><br><span class="line">            File dest = <span class="keyword">new</span> File(FILE_PATH + newFileName);</span><br><span class="line">            <span class="comment">//保存文件到本地</span></span><br><span class="line">            file.transferTo(dest);</span><br><span class="line">            <span class="keyword">return</span> newFileName;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"文件上传失败"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>3、图片映射路径（映射这后，就可以通过”<a href="http://locallhost:8089/images/文件名&quot;访问图片了）" target="_blank" rel="noopener">http://locallhost:8089/images/文件名&quot;访问图片了）</a></strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 配置图片路映射</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebMvcConfig</span> <span class="keyword">extends</span> <span class="title">WebMvcConfigurerAdapter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> </span>&#123;</span><br><span class="line">        registry.addResourceHandler(<span class="string">"/images/**"</span>).addResourceLocations(<span class="string">"file:G:/myjava/upload/"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>全部完成，希望对新手朋友有所帮助。</p>
<p><font color="red">注：</font>转载于：<a href="https://blog.csdn.net/qq_20649143/article/details/106031212" target="_blank" rel="noopener">https://blog.csdn.net/qq_20649143/article/details/106031212</a></p>
<hr>
<h4 id="32-在tomcat中设置history模式，使vue-router使用history模式："><a href="#32-在tomcat中设置history模式，使vue-router使用history模式：" class="headerlink" title="32. 在tomcat中设置history模式，使vue-router使用history模式："></a>32. <font color="#00AFF0"><strong>在tomcat中设置history模式，使vue-router使用history模式：</strong></font></h4><p><code>vue-router</code>文档中只有关于<code>Apache</code>，<code>nginx</code>等配置的说明，同过查询找到了以下方法解决<code>tomcat</code>下<code>history</code>模式的问题。创建<code>WEB-INF</code>文件，文件夹中创建<code>web.xml</code></p>
<p>在<code>web.xml</code>中输入以下内容</p>
<p><img src="https://img-blog.csdnimg.cn/20190529164958564.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N4czE5OTU=,size_16,color_FFFFFF,t_70" alt="需要创建WEB-INF文件夹"><br><img src="https://img-blog.csdnimg.cn/20190529165103884.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N4czE5OTU=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>在<code>web.xml</code>中输入以下内容</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">"http://java.sun.com/xml/ns/javaee"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://java.sun.com/xml/ns/javaee</span></span></span><br><span class="line"><span class="tag"><span class="string">                      http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">version</span>=<span class="string">"3.0"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">metadata-complete</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>webapp<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span></span><br><span class="line">     webapp</span><br><span class="line">  <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">error-page</span>&gt;</span>  </span><br><span class="line">   <span class="tag">&lt;<span class="name">error-code</span>&gt;</span>404<span class="tag">&lt;/<span class="name">error-code</span>&gt;</span>  </span><br><span class="line">   <span class="tag">&lt;<span class="name">location</span>&gt;</span>/<span class="tag">&lt;/<span class="name">location</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">error-page</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>按照这个配置完成后发现页面还是空白的，经过研究发现我们还需要再<code>vue-router</code>中进行配置，因为代码是在<code>mobile</code>目录下，路由进行以下配置。</p>
<p><img src="https://img-blog.csdnimg.cn/20190529165850380.png" alt="路由配置"><br>我使用的<code>vue-cli 3.x vue-cli</code>打包配置还需要设置以下内容：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  publicPath: <span class="string">"/mobile"</span>,</span><br><span class="line">  configureWebpack: &#123;</span><br><span class="line">    performance: &#123;</span><br><span class="line">      hints: <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>这样我们就实现tomcat下配置history模式了。</p>
<p><font color="red">注：</font>转载于：<a href="https://blog.csdn.net/sxs1995/article/details/90674382" target="_blank" rel="noopener">https://blog.csdn.net/sxs1995/article/details/90674382</a></p>
<hr>
<h4 id="1-共勉"><a href="#1-共勉" class="headerlink" title="1. 共勉"></a>1. <font color="#00AFF0">共勉</font></h4><p><font color="red">注：</font>转载于：共勉</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/note/2021/08/07/JavaScript/" rel="next" title="JavaScript">
                <i class="fa fa-chevron-left"></i> JavaScript
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/note/2021/08/15/HTTP%20%E5%8D%8F%E8%AE%AE/" rel="prev" title="HTTP 协议">
                HTTP 协议 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/note/images/dog.jpg"
                alt="F゛" />
            
              <p class="site-author-name" itemprop="name">F゛</p>
              <p class="site-description motion-element" itemprop="description">study hard and make progress every day!</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/note/archives/%7C%7Carchive">
              
                  <span class="site-state-item-count">22</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-vue-element-admin-打包部署到线上服务器"><span class="nav-number">1.</span> <span class="nav-text">1.  vue-element-admin 打包部署到线上服务器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-正则表达式验证"><span class="nav-number">2.</span> <span class="nav-text">2.  正则表达式验证</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-隐藏内容但仍保持占位的css写法"><span class="nav-number">3.</span> <span class="nav-text">3.  隐藏内容但仍保持占位的css写法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-如何获取Element-中时间组件el-date-picker的时间"><span class="nav-number">4.</span> <span class="nav-text">4.  如何获取Element 中时间组件el-date-picker的时间</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-vue-element-admin动态路由无限循环的解决方法"><span class="nav-number">5.</span> <span class="nav-text">5.  vue-element-admin动态路由无限循环的解决方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-vue-element-admin-——data-functions-should-return-an-object-告警"><span class="nav-number">6.</span> <span class="nav-text">6.   vue-element-admin ——data functions should return an object:告警</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-关于vue-element-admin登录流程"><span class="nav-number">7.</span> <span class="nav-text">7.   关于vue-element-admin登录流程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-GET-http-192-168-0-180-8080-sockjs-node-info-t-1591789655464-net-ERR-CONNECTION-TIMED-OUT"><span class="nav-number">8.</span> <span class="nav-text">8. GET http:&#x2F;&#x2F;192.168.0.180:8080&#x2F;sockjs-node&#x2F;info?t&#x3D;1591789655464 net::ERR_CONNECTION_TIMED_OUT</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#9-关于-VUE-APP-BASE-API-的总结"><span class="nav-number">9.</span> <span class="nav-text">9. 关于 VUE_APP_BASE_API 的总结</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#10-VUE监听路由变化的几种方式"><span class="nav-number">10.</span> <span class="nav-text">10. VUE监听路由变化的几种方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#11-vue-element-admin路由切换到添加或编辑页面后实现侧边栏高亮（方法一）"><span class="nav-number">11.</span> <span class="nav-text">11. vue-element-admin路由切换到添加或编辑页面后实现侧边栏高亮（方法一）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#12-vue-element-admin-使用了hidden的路由如何让左侧高亮（方法二）"><span class="nav-number">12.</span> <span class="nav-text">12. vue-element-admin 使用了hidden的路由如何让左侧高亮（方法二）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#13-element-UI-upload组件上传附件格式限制"><span class="nav-number">13.</span> <span class="nav-text">13. element UI upload组件上传附件格式限制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#14-Echarts多条折线图-y轴数值与实际值不一致的解决方法"><span class="nav-number">14.</span> <span class="nav-text">14. Echarts多条折线图 y轴数值与实际值不一致的解决方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#15-element-el-select下拉框修改样式-el-select-dropdown："><span class="nav-number">15.</span> <span class="nav-text">15. element el-select下拉框修改样式 el-select-dropdown：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#16-element中el-table，type-’expand’展开行，-expand-change-”-“事件动态数据刷新问题："><span class="nav-number">16.</span> <span class="nav-text">16. element中el-table，type&#x3D;’expand’展开行，@expand-change&#x3D;” “事件动态数据刷新问题：**</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#17-vue-实现-表格拖拽-包括表格嵌套表格拖拽："><span class="nav-number">17.</span> <span class="nav-text">17. vue 实现 表格拖拽 包括表格嵌套表格拖拽：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#18-vue的form表单在提交成功后置空："><span class="nav-number">18.</span> <span class="nav-text">18. vue的form表单在提交成功后置空：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#19-vue-websocket实现数据实时推送以及本地测试："><span class="nav-number">19.</span> <span class="nav-text">19. vue+websocket实现数据实时推送以及本地测试：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#20-使用element-ui-table-expand展开行实现手风琴效果："><span class="nav-number">20.</span> <span class="nav-text">20. 使用element-ui table expand展开行实现手风琴效果：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#21-element-ui中的table记住分页多选框选中的数据："><span class="nav-number">21.</span> <span class="nav-text">21. element-ui中的table记住分页多选框选中的数据：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#22-封装WebSocket（建立链接、主动关闭）："><span class="nav-number">22.</span> <span class="nav-text">22. 封装WebSocket（建立链接、主动关闭）：</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#一丶前言"><span class="nav-number">22.1.</span> <span class="nav-text">一丶前言</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#二、HTML5-WebSocket"><span class="nav-number">22.2.</span> <span class="nav-text">二、HTML5 WebSocket</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#三、封装websocket"><span class="nav-number">22.3.</span> <span class="nav-text">三、封装websocket</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#四、使用此socketJs文件（主要在vue项目中使用封装的socket）"><span class="nav-number">22.4.</span> <span class="nav-text">四、使用此socketJs文件（主要在vue项目中使用封装的socket）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#五、遇到的问题"><span class="nav-number">22.5.</span> <span class="nav-text">五、遇到的问题</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#23-Vue-核心之数据劫持（一）："><span class="nav-number">23.</span> <span class="nav-text">23. Vue 核心之数据劫持（一）：</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#前瞻"><span class="nav-number">23.1.</span> <span class="nav-text">前瞻</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#回顾一下Object-defineProperty"><span class="nav-number">23.2.</span> <span class="nav-text">回顾一下Object.defineProperty</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#什么是数据劫持"><span class="nav-number">23.3.</span> <span class="nav-text">什么是数据劫持</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#监听对象属性的变化"><span class="nav-number">23.4.</span> <span class="nav-text">监听对象属性的变化</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#监听数组的变化"><span class="nav-number">23.5.</span> <span class="nav-text">监听数组的变化</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#实现对象属性代理"><span class="nav-number">23.6.</span> <span class="nav-text">实现对象属性代理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#总结"><span class="nav-number">23.7.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#24-数据劫持（数据代理）（二）："><span class="nav-number">24.</span> <span class="nav-text">24. 数据劫持（数据代理）（二）：</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Object-defineProperty"><span class="nav-number">24.1.</span> <span class="nav-text">Object.defineProperty</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Proxy"><span class="nav-number">24.2.</span> <span class="nav-text">Proxy</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#一道面试题"><span class="nav-number">24.3.</span> <span class="nav-text">一道面试题</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#25-element-ui-table-span-method（行合并）："><span class="nav-number">25.</span> <span class="nav-text">25. element-ui table :span-method（行合并）：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#26-forEach-is-not-a-function："><span class="nav-number">26.</span> <span class="nav-text">26. forEach is not a function：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#27-el-form表单验证的trigger类型："><span class="nav-number">27.</span> <span class="nav-text">27. el-form表单验证的trigger类型：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#28-Element-UI做校验进行测试控制台有黄色警告如何解决："><span class="nav-number">28.</span> <span class="nav-text">28. Element-UI做校验进行测试控制台有黄色警告如何解决：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#29-Element使用富文本编辑器TinyMCE使其支持图片上传："><span class="nav-number">29.</span> <span class="nav-text">29. Element使用富文本编辑器TinyMCE使其支持图片上传：</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#默认位置"><span class="nav-number">29.1.</span> <span class="nav-text">默认位置</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#快速使用"><span class="nav-number">29.2.</span> <span class="nav-text">快速使用</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#取消菜单栏"><span class="nav-number">29.3.</span> <span class="nav-text">取消菜单栏</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#图片上传"><span class="nav-number">29.4.</span> <span class="nav-text">图片上传</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#默认上传"><span class="nav-number">29.5.</span> <span class="nav-text">默认上传</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#自定义上传"><span class="nav-number">29.6.</span> <span class="nav-text">自定义上传</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#关于服务端图片上传功能"><span class="nav-number">29.7.</span> <span class="nav-text">关于服务端图片上传功能</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#内容参考"><span class="nav-number">29.8.</span> <span class="nav-text">内容参考</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#30-修改vue-element-admin中Tinymce编辑器的图片上传路径："><span class="nav-number">30.</span> <span class="nav-text">30. 修改vue-element-admin中Tinymce编辑器的图片上传路径：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#31-VUE-ELEMENT-ADMIN使用TINYMCE富文本编辑器："><span class="nav-number">31.</span> <span class="nav-text">31. VUE-ELEMENT-ADMIN使用TINYMCE富文本编辑器：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#32-在tomcat中设置history模式，使vue-router使用history模式："><span class="nav-number">32.</span> <span class="nav-text">32. 在tomcat中设置history模式，使vue-router使用history模式：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-共勉"><span class="nav-number">33.</span> <span class="nav-text">1. 共勉</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">F゛</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/note/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/note/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/note/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/note/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/note/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/note/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/note/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/note/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/note/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/note/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/note/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/note/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/note/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/note/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  


  
  <script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
  
</body>
</html>
